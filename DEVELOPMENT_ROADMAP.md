# خطة تطوير النظام
## نظام إدارة المهام والحضور - قسم التسويات والمطابقة

---

## أولوية عالية (أساسي)

### 1. واجهة المستخدم وتحسين التجربة
- [ ] **تحسين التصميم**: تناسق الألوان، خطوط عربية أفضل، تباعد وقراءة أوضح
- [x] **إشعارات**: تنبيهات (Toast) للنجاح/الخطأ بدلاً من `alert`
- [x] **حالات التحميل**: Skeleton أو Spinner موحّد في كل الصفحات
- [x] **تحقق من النماذج**: رسائل خطأ واضحة عند الإدخال الخاطئ
- [ ] **استجابة الشاشات**: تحسين العرض على الموبايل والتابلت

### 2. المهام والتنفيذ
- [x] **تفاصيل التنفيذ**: صفحة عرض تفاصيل تنفيذ المهمة (من نفّذ، متى، الملاحظات)
- [x] **فلاتر وبحث**: فلترة المهام اليومية حسب الحالة/المسؤول/التاريخ
- [x] **المرفقات**: رفع مرفقات مع تنفيذ المهمة (ومعالجة التخزين)
- [ ] **سجل المهام**: عرض تاريخ تنفيذات الموظف وإحصائياته

### 3. التقارير والتصدير
- [x] **تصدير PDF**: تقرير يومي/شهري PDF (البنية موجودة عبر pdfkit)
- [ ] **تقارير أسبوعية**: صفحة/فلتر تقرير أسبوعي منفصل
- [ ] **توزيع الفئات شهرياً**: تقرير "لكل موظف × كل فئة" شهرياً مع رسوم بيانية
- [x] **محدد التاريخ**: اختيار نطاق تاريخ للتقارير بدلاً من إدخال يدوي فقط

### 4. لوحة التحكم التلفزيونية (TV)
- [x] **وضع الزائر**: زر أو رابط `/tv?visitor=1` لإخفاء الأسماء والبيانات الحساسة
- [x] **إعدادات TV**: صفحة Admin لتعديل (فاصل الشرائح، تفعيل/إيقاف شرائح، تحديث تلقائي)
- [x] **خطوط أكبر**: تحسين الوضوح على شاشة 86 بوصة
- [ ] **دخول ملء الشاشة**: تفعيل Fullscreen API أو توجيه المستخدم له

---

## أولوية متوسطة

### 5. إدارة المستخدمين والأمان
- [x] **تغيير كلمة المرور**: للمستخدم الحالي من الإعدادات أو الملف الشخصي
- [ ] **سياسة كلمة المرور**: حد أدنى للطول، تعقيد، عدم إعادة استخدام آخر كلمات المرور
- [x] **عرض سجل التدقيق**: صفحة Admin لتصفية وعرض `audit_log` (مستخدم، إجراء، تاريخ)
- [ ] **تحديث الجلسة**: تمديد الجلسة أو إعادة تسجيل الدخول عند انتهاء التوكن

### 6. الحضور
- [x] **تقويم الحضور**: عرض شهري (أيام الحضور/الغياب) لكل موظف
- [ ] **تقرير الحضور**: تصدير Excel للحضور لفترة محددة
- [ ] **تنبيهات**: تنبيه عند عدم تسجيل حضور بعد وقت معيّن (إن وُجدت قاعدة لذلك)

### 7. الفئات والقوالب والجداول
- [ ] **ترتيب العناصر**: إمكانية ترتيب الفئات أو القوالب (ترتيب عرض)
- [ ] **تعطيل بدل الحذف**: تعطيل جدول/قالب مع الاحتفاظ بالبيانات التاريخية
- [ ] **نسخ جدول**: "نسخ جدول" لإنشاء جدول جديد بناءً على واحد موجود مع تعديل بسيط

### 8. التحقق والصلاحيات
- [ ] **التحقق من المدخلات (Backend)**: استخدام مكتبة (مثل `express-validator`) للتحقق من الـ API
- [ ] **تحديد الصلاحيات بدقة**: صلاحيات على مستوى الميزات (مثلاً: تقارير دون تصدير)
- [ ] **Rate limiting**: تحديد معدل الطلبات على نقاط الـ API الحساسة

---

## أولوية منخفضة

### 9. أداء وتقني
- [ ] **ترقيم الصفحات**: Pagination لقوائم المستخدمين، المهام، التقارير، السجل
- [ ] **تخزين مؤقت**: Cache لبيانات لوحة TV أو التقارير المتكررة عند الحاجة
- [ ] **توثيق API**: Swagger/OpenAPI لوصف نقاط الـ API
- [ ] **بيئة Staging**: إعداد منفصل للتجارب قبل الإنتاج (إن وُجدت بيئة)

### 10. الاختبارات والجودة
- [ ] **اختبارات وحدة**: للـ controllers الأساسية (تسجيل الدخول، المهام، التقارير)
- [ ] **اختبارات تكامل**: لمسارات الـ API الرئيسية
- [ ] **E2E**: سيناريوهات تسجيل الدخول، إنشاء مهمة، تنفيذها، تقرير بسيط

### 11. نشر وتشغيل
- [ ] **Health check**: مسار مثل `/api/health` للتحقق من صلاحية الخادم وقاعدة البيانات
- [ ] **سجلات منظمة**: استخدام Winston أو Pino بدلاً من `console.log` فقط
- [ ] **مراقبة الأخطاء**: إرسال أخطاء الإنتاج إلى خدمة (مثل Sentry) إن رغبت

---

## اقتراح ترتيب التنفيذ (مراحل)

| المرحلة | المخرجات المتوقعة |
|--------|-------------------|
| **1** | إشعارات (Toast)، تحسين تحميل النماذج، تحقق أساسي من الحقول |
| **2** | تفاصيل تنفيذ المهمة، فلاتر المهام، تحسين صفحة التقارير + PDF |
| **3** | إعدادات TV، وضع الزائر، تحسين وضوح شاشة TV |
| **4** | تغيير كلمة المرور، عرض سجل التدقيق، تحسين سياسة كلمات المرور |
| **5** | مرفقات التنفيذ، تقويم الحضور، تحسينات إضافية حسب الأولوية |

---

## ملاحظات

- نفّذ التعديلات على فرع منفصل (مثل `develop`) ثم ادمج في `main` بعد المراجعة.
- حافظ على **الواجهة بالعربية** وجاهزية **TV** لشاشة 86 بوصة في أي تحسين جديد.
- أي تغيير يمس الصلاحيات أو التخزين يجب أن يُوثَّق في `README` أو `SETUP`.

إذا حدّدت المرحلة أو الميزة التي تريد البدء بها، يمكن تفصيلها إلى مهام فرعية وتنفيذها خطوة بخطوة.

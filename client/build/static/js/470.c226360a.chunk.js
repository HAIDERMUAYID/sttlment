"use strict";(self.webpackChunksttlment_client=self.webpackChunksttlment_client||[]).push([[470],{25851(e,t,n){n.d(t,{T:()=>a});var s=n(2240),r=n(52422);function a(e,t){const n=(0,s.n)(e=>e.user);return!!n&&(0,r._m)(n.permissions,n.role,e,t)}},72301(e,t,n){n.d(t,{A:()=>r});n(65043);var s=n(70579);function r(e){let{message:t="\u062c\u0627\u0631\u064a \u0627\u0644\u062a\u062d\u0645\u064a\u0644..."}=e;return(0,s.jsxs)("div",{className:"loading-wrapper",children:[(0,s.jsx)("div",{className:"loading-spinner"}),(0,s.jsx)("p",{className:"loading-message",children:t})]})}},83470(e,t,n){n.r(t),n.d(t,{default:()=>I});var s=n(22555),r=n(65043),a=n(94505),l=n(25851),o=n(51704),c=n(72301),i=n(92382),d=n(38298),m=n(7118),x=n(53639),u=n(26511),h=n(28006),b=n(39292),p=n(20920),g=n(13190),v=n(40614),f=n(41680),y=n(93537),j=n(85948),_=n(15074),N=n(70579);const k=[{value:"contains",label:"\u064a\u062d\u062a\u0648\u064a \u0639\u0644\u0649"},{value:"equals",label:"\u064a\u0633\u0627\u0648\u064a"},{value:"startsWith",label:"\u064a\u0628\u062f\u0623 \u0628\u0640"}];function w(e){let{columnKey:t,columnLabel:n,options:s,value:a,onChange:l,sortDirection:o,onSortChange:c,trigger:i,className:d}=e;const[m,x]=r.useState(!1),[u,h]=r.useState(""),[p,g]=r.useState("contains"),[v,f]=r.useState(!0),[w,C]=r.useState(a),A=r.useRef(null),S=r.useRef(null);r.useEffect(()=>{C(a)},[a,m]);const I=r.useMemo(()=>{const e=(w||"").split(",").map(e=>e.trim()).filter(Boolean);return new Set(e)},[w]),D=r.useMemo(()=>{let e=s;if(u.trim()){const t=u.toLowerCase();e=e.filter(e=>{const n=(e||"").toLowerCase();return"contains"===p?n.includes(t):"equals"===p?n===t:"startsWith"===p?n.startsWith(t):n.includes(t)})}return e},[s,u,p]),E=D.length>0&&D.every(e=>I.has(e)),L=D.some(e=>I.has(e))&&!E;r.useEffect(()=>{S.current&&(S.current.indeterminate=L)},[L]);return(0,N.jsxs)("div",{ref:A,className:(0,_.cn)("relative",d),children:[(0,N.jsx)("div",{onClick:()=>x(!m),className:"cursor-pointer",children:i}),m&&(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)("div",{className:"absolute z-50 mt-1 rounded-xl border border-slate-200 bg-white shadow-xl py-3 min-w-[280px] max-w-[320px]",style:{left:0,top:"100%"},children:[(0,N.jsxs)("div",{className:"px-3 mb-2",children:[(0,N.jsx)("p",{className:"text-xs font-bold text-slate-600 mb-1.5",children:"\u0641\u0631\u0632"}),(0,N.jsxs)("div",{className:"flex gap-2",children:[(0,N.jsxs)("button",{type:"button",onClick:()=>c("desc"===o?null:"desc"),className:(0,_.cn)("flex items-center gap-1 px-2 py-1.5 rounded-lg text-xs font-medium transition-colors","desc"===o?"bg-[#026174] text-white":"bg-slate-100 text-slate-700 hover:bg-slate-200"),children:[(0,N.jsx)(y.A,{className:"w-3.5 h-3.5"}),"\u062a\u0646\u0627\u0632\u0644\u064a"]}),(0,N.jsxs)("button",{type:"button",onClick:()=>c("asc"===o?null:"asc"),className:(0,_.cn)("flex items-center gap-1 px-2 py-1.5 rounded-lg text-xs font-medium transition-colors","asc"===o?"bg-[#026174] text-white":"bg-slate-100 text-slate-700 hover:bg-slate-200"),children:[(0,N.jsx)(j.A,{className:"w-3.5 h-3.5"}),"\u062a\u0635\u0627\u0639\u062f\u064a"]})]})]}),(0,N.jsxs)("div",{className:"px-3 mb-2",children:[(0,N.jsx)("p",{className:"text-xs font-bold text-slate-600 mb-1.5",children:"\u062a\u0635\u0641\u064a\u0629"}),(0,N.jsxs)("div",{className:"flex gap-1.5",children:[(0,N.jsxs)("div",{className:"relative flex-1",children:[(0,N.jsx)(b.A,{className:"absolute right-2 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-slate-500"}),(0,N.jsx)("input",{type:"text",placeholder:"\u0628\u062d\u062b",value:u,onChange:e=>h(e.target.value),className:"w-full pr-8 pl-2 py-1.5 text-xs border border-slate-300 rounded-lg bg-white focus:outline-none focus:ring-2 focus:ring-[#026174]/30 focus:border-[#026174]"})]}),(0,N.jsx)("select",{value:p,onChange:e=>g(e.target.value),className:"px-2 py-1.5 text-xs border border-slate-300 rounded-lg bg-white focus:outline-none focus:ring-1 focus:ring-[#026174]/30",children:k.map(e=>(0,N.jsx)("option",{value:e.value,children:e.label},e.value))})]})]}),(0,N.jsx)("div",{className:"px-3 mb-2",children:(0,N.jsxs)("div",{className:"max-h-48 overflow-y-auto border border-slate-200 rounded-lg",children:[(0,N.jsxs)("label",{className:"flex items-center gap-2 px-3 py-2 hover:bg-slate-50 cursor-pointer border-b border-slate-100",children:[(0,N.jsx)("input",{type:"checkbox",ref:S,checked:E,onChange:()=>{if(E){const e=new Set(I);D.forEach(t=>e.delete(t));const t=s.filter(t=>e.has(t)).join(",");C(t),v&&l(t)}else{const e=new Set(I);D.forEach(t=>e.add(t));const t=s.filter(t=>e.has(t)).join(",");C(t),v&&l(t)}},className:"rounded border-slate-300 text-[#026174] focus:ring-[#026174]"}),(0,N.jsx)("span",{className:"text-xs font-semibold text-slate-800",children:"\u062a\u062d\u062f\u064a\u062f \u0627\u0644\u0643\u0644"})]}),0===D.length?(0,N.jsx)("div",{className:"py-4 text-center text-xs text-slate-500",children:"\u0644\u0627 \u062a\u0648\u062c\u062f \u0646\u062a\u0627\u0626\u062c"}):D.map(e=>(0,N.jsxs)("label",{className:"flex items-center gap-2 px-3 py-1.5 hover:bg-slate-50 cursor-pointer text-xs",children:[(0,N.jsx)("input",{type:"checkbox",checked:I.has(e),onChange:()=>(e=>{const t=new Set(I);t.has(e)?t.delete(e):t.add(e);const n=s.filter(e=>t.has(e)).join(",");C(n),v&&l(n)})(e),className:"rounded border-slate-300 text-[#026174] focus:ring-[#026174]"}),(0,N.jsx)("span",{className:"truncate text-slate-800",children:e||"-"})]},e))]})}),(0,N.jsxs)("div",{className:"px-3 flex items-center gap-2 flex-wrap",children:[(0,N.jsxs)("label",{className:"flex items-center gap-1.5 cursor-pointer",children:[(0,N.jsx)("input",{type:"checkbox",checked:v,onChange:e=>f(e.target.checked),className:"rounded border-slate-300 text-[#026174] focus:ring-[#026174]"}),(0,N.jsx)("span",{className:"text-xs text-slate-600",children:"\u062a\u0637\u0628\u064a\u0642 \u062a\u0644\u0642\u0627\u0626\u064a"})]}),(0,N.jsxs)("div",{className:"flex gap-1.5 ms-auto",children:[(0,N.jsx)("button",{type:"button",onClick:()=>{l(w),x(!1),h("")},className:"px-3 py-1.5 rounded-lg text-xs font-medium text-white",style:{background:"linear-gradient(135deg, #026174, #068294)"},children:"\u062a\u0637\u0628\u064a\u0642 \u0639\u0627\u0645\u0644 \u0627\u0644\u062a\u0635\u0641\u064a\u0629"}),(0,N.jsx)("button",{type:"button",onClick:()=>{C(""),l(""),x(!1),h("")},className:"px-3 py-1.5 rounded-lg text-xs font-medium bg-slate-100 hover:bg-slate-200 text-slate-700",children:"\u0625\u0644\u063a\u0627\u0621 \u062a\u062d\u062f\u064a\u062f \u0639\u0627\u0645\u0644 \u0627\u0644\u062a\u0635\u0641\u064a\u0629"})]})]})]}),(0,N.jsx)("div",{className:"fixed inset-0 z-40",onClick:()=>x(!1),"aria-hidden":!0})]})]})}var C=n(11238);const A=e=>{let{children:t}=e;return(0,N.jsxs)("span",{className:"inline-flex items-center gap-1",children:[t,(0,N.jsx)(i.A,{className:"w-4 h-4 opacity-90 flex-shrink-0 text-current",strokeWidth:2.5})]})},S=e=>{let{value:t,label:n}=e;const s=t?t.split(",").filter(Boolean).length:0,r=s>0;return(0,N.jsxs)("div",{className:"flex items-center gap-1.5 w-full min-w-0 py-1.5 px-2 rounded-md border transition-all cursor-pointer ".concat(r?"merchant-filter-trigger-active":"merchant-filter-trigger"),children:[(0,N.jsx)(d.A,{className:"w-3.5 h-3.5 flex-shrink-0 ".concat(r?"text-[#026174]":"text-slate-500")}),(0,N.jsx)("span",{className:"text-xs truncate ".concat(r?"text-[#026174] font-medium":"text-slate-600"),children:s>0?"".concat(s," \u0645\u062d\u062f\u062f"):n})]})},I=()=>{var e,t,n;const[i,y]=(0,r.useState)([]),[j,_]=(0,r.useState)(!0),[k,I]=(0,r.useState)({page:1,limit:50,total:0,totalPages:0}),[D,E]=(0,r.useState)({search:"",governorate:"",ministry:"",bank_code:"",commission_type:""}),[L,W]=(0,r.useState)({merchant_id:"",governorate:"",ministry:"",directorate_name:"",bank_code:"",settlement_name:"",commission_type:"",device_count:"",iban:"",account_number:"",branch_name:""}),[T,B]=(0,r.useState)({column:null,direction:null}),[M,P]=(0,r.useState)({governorates:[],ministries:[],bankCodes:[],merchantIds:[],directorates:[],settlements:[],deviceCounts:[],ibans:[],accountNumbers:[],branches:[]}),{toast:O}=(0,o.dj)(),K=(0,l.T)("merchants","create"),R=((0,l.T)("merchants","edit"),(0,l.T)("merchants","delete"),(0,l.T)("merchants","import")),F=(0,l.T)("merchants","export"),[U,q]=(0,r.useState)(!1),[z,V]=(0,r.useState)(!1),[G,H]=(0,r.useState)(null),[Q,J]=(0,r.useState)(!1),[X,Y]=(0,r.useState)(null),Z=(0,r.useRef)(null),[$,ee]=(0,r.useState)({merchant_id:"",governorate:"",ministry:"",directorate_name:"",details:"",device_count:0,iban:"",account_key:"",account_number:"",branch_name:"",branch_number:"",bank_code:"",bank_name:"",bank_name_alt:"",iban_length_check:23,notes:"",settlement_name:"",commission_type:"\u062d\u0643\u0648\u0645\u064a"});(0,r.useEffect)(()=>{te(),ne()},[k.page,D,L]);const te=async()=>{try{var e,t;_(!0);const n=(0,s.A)((0,s.A)((0,s.A)((0,s.A)((0,s.A)((0,s.A)((0,s.A)((0,s.A)((0,s.A)((0,s.A)((0,s.A)((0,s.A)({page:k.page,limit:k.limit},Object.fromEntries(Object.entries(D).filter(e=>{let[t,n]=e;return n}))),L.merchant_id&&{merchant_id:L.merchant_id}),L.iban&&{iban:L.iban}),L.directorate_name&&{directorate_name:L.directorate_name}),L.settlement_name&&{settlement_name:L.settlement_name}),L.device_count&&{device_count:L.device_count}),L.account_number&&{account_number:L.account_number}),L.branch_name&&{branch_name:L.branch_name}),(L.governorate||D.governorate)&&{governorate:L.governorate||D.governorate}),(L.ministry||D.ministry)&&{ministry:L.ministry||D.ministry}),(L.bank_code||D.bank_code)&&{bank_code:L.bank_code||D.bank_code}),(L.commission_type||D.commission_type)&&{commission_type:L.commission_type||D.commission_type}),r=new URLSearchParams(Object.fromEntries(Object.entries(n).filter(e=>{let[t,n]=e;return null!=n&&""!==n}))),l=await a.A.get("/merchants?".concat(r));y((null===(e=l.data)||void 0===e?void 0:e.merchants)||[]),I((null===(t=l.data)||void 0===t?void 0:t.pagination)||{page:1,limit:50,total:0,totalPages:0})}catch(l){var n,r;console.error("Error fetching merchants:",l),O({title:"\u062e\u0637\u0623",description:(null===(n=l.response)||void 0===n||null===(r=n.data)||void 0===r?void 0:r.error)||"\u062e\u0637\u0623 \u0641\u064a \u062c\u0644\u0628 \u0627\u0644\u062a\u062c\u0627\u0631",variant:"destructive"}),y([]),I({page:1,limit:50,total:0,totalPages:0})}finally{_(!1)}},ne=async()=>{try{const e=(await a.A.get("/merchants/filter-options")).data||{};P({governorates:e.governorates||[],ministries:e.ministries||[],bankCodes:e.bankCodes||[],merchantIds:e.merchantIds||[],directorates:e.directorates||[],settlements:e.settlements||[],deviceCounts:e.deviceCounts||[],ibans:e.ibans||[],accountNumbers:e.accountNumbers||[],branches:e.branches||[]})}catch(e){console.error("\u062e\u0637\u0623 \u0641\u064a \u062c\u0644\u0628 \u062e\u064a\u0627\u0631\u0627\u062a \u0627\u0644\u0641\u0644\u062a\u0631\u0629:",e)}},se=()=>{H(null),ee({merchant_id:"",governorate:"",ministry:"",directorate_name:"",details:"",device_count:0,iban:"",account_key:"",account_number:"",branch_name:"",branch_number:"",bank_code:"",bank_name:"",bank_name_alt:"",iban_length_check:23,notes:"",settlement_name:"",commission_type:"\u062d\u0643\u0648\u0645\u064a"})},re=(e,t)=>{E(n=>(0,s.A)((0,s.A)({},n),{},{[e]:t})),I(e=>(0,s.A)((0,s.A)({},e),{},{page:1}))},ae=(e,t)=>{if(W(n=>(0,s.A)((0,s.A)({},n),{},{[e]:t})),I(e=>(0,s.A)((0,s.A)({},e),{},{page:1})),["governorate","ministry","bank_code","commission_type"].includes(e)){var n;const r=(null===(n=(t||"").split(",")[0])||void 0===n?void 0:n.trim())||"";E(t=>(0,s.A)((0,s.A)({},t),{},{[e]:r}))}"merchant_id"===e&&E(e=>{var n;return(0,s.A)((0,s.A)({},e),{},{search:(null===(n=(t||"").split(",")[0])||void 0===n?void 0:n.trim())||""})})},le=(e,t)=>{B({column:e,direction:t})},oe=(0,r.useMemo)(()=>{let e=i;const t=(t,n)=>{const s=(e=>{const t=(e||"").split(",").map(e=>e.trim()).filter(Boolean);return t.length?new Set(t):null})(n);s&&(e=e.filter(e=>s.has(String(t(e)||""))))};if(t(e=>e.merchant_id,L.merchant_id),t(e=>e.governorate,L.governorate||D.governorate),t(e=>e.ministry,L.ministry||D.ministry),t(e=>e.directorate_name,L.directorate_name),t(e=>e.bank_code||e.bank_name,L.bank_code||D.bank_code),t(e=>e.settlement_name,L.settlement_name),t(e=>e.commission_type,L.commission_type||D.commission_type),t(e=>String(e.device_count),L.device_count),t(e=>e.iban,L.iban),t(e=>e.account_number,L.account_number),t(e=>e.branch_name,L.branch_name),T.column&&T.direction){const t=T.column,n="asc"===T.direction?1:-1;e=[...e].sort((e,s)=>{var r,a;const l=null!==(r=e[t])&&void 0!==r?r:"",o=null!==(a=s[t])&&void 0!==a?a:"";return"number"===typeof l&&"number"===typeof o?(l-o)*n:String(l).localeCompare(String(o))*n})}return e},[i,D,L,T]),ce=(0,r.useMemo)(()=>({total:k.total||i.length||0,govCount:i.filter(e=>"\u062d\u0643\u0648\u0645\u064a"===e.commission_type).length,privateCount:i.filter(e=>"\u062e\u0627\u0635"===e.commission_type).length,uniqueGovernorates:new Set(i.map(e=>e.governorate).filter(Boolean)).size}),[i,k.total]),ie=Object.values(D).some(Boolean)||Object.values(L).some(Boolean)||T.column;return(0,N.jsx)("div",{className:"min-h-screen",dir:"rtl",style:{padding:"1.5rem 2rem",background:"linear-gradient(180deg, #f1f5f9 0%, #e2e8f0 100%)"},children:(0,N.jsxs)("div",{className:"mx-auto",style:{width:"100%",maxWidth:"1400px"},children:[(0,N.jsxs)("div",{className:"page-header-teal rounded-xl flex flex-wrap items-center justify-between gap-4 p-5 mb-6",style:{background:"linear-gradient(135deg, #026174 0%, #068294 100%)",color:"#ffffff",boxShadow:"0 10px 30px rgba(2, 97, 116, 0.35)"},children:[(0,N.jsxs)("div",{children:[(0,N.jsx)("h1",{className:"text-2xl font-bold m-0 text-white",children:"\u0625\u062f\u0627\u0631\u0629 \u0627\u0644\u062a\u062c\u0627\u0631"}),(0,N.jsx)("p",{className:"text-sm opacity-90 mt-1 m-0 text-white",children:"\u0625\u062f\u0627\u0631\u0629 \u062d\u0633\u0627\u0628\u0627\u062a \u0627\u0644\u062c\u0647\u0627\u062a \u0627\u0644\u062d\u0643\u0648\u0645\u064a\u0629 \u0648\u0627\u0644\u0642\u0637\u0627\u0639 \u0627\u0644\u062e\u0627\u0635\u060c \u0627\u0644\u0645\u0635\u0627\u0631\u0641\u060c \u0648\u0623\u0631\u0642\u0627\u0645 \u0627\u0644\u062d\u0633\u0627\u0628\u0627\u062a \u0627\u0644\u0645\u0631\u062a\u0628\u0637\u0629 \u0628\u0627\u0644\u062a\u0633\u0648\u064a\u0627\u062a."})]}),(0,N.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[F&&(0,N.jsx)("button",{type:"button",onClick:async()=>{try{var e;const t=new URLSearchParams((0,s.A)({page:1,limit:1e5},Object.fromEntries(Object.entries(D).filter(e=>{let[t,n]=e;return n})))),n=(null===(e=(await a.A.get("/merchants?".concat(t.toString()))).data)||void 0===e?void 0:e.merchants)||[];if(!n||0===n.length)return void O({title:"\u062a\u0646\u0628\u064a\u0647",description:"\u0644\u0627 \u062a\u0648\u062c\u062f \u0628\u064a\u0627\u0646\u0627\u062a \u062d\u0627\u0644\u064a\u0627\u064b \u0644\u0644\u062a\u0635\u062f\u064a\u0631 \u062d\u0633\u0628 \u0627\u0644\u0641\u0644\u0627\u062a\u0631 \u0627\u0644\u062d\u0627\u0644\u064a\u0629",variant:"warning"});const r=n.filter(e=>"\u062d\u0643\u0648\u0645\u064a"===e.commission_type),l=n.filter(e=>"\u062e\u0627\u0635"===e.commission_type),o=e=>e.map(e=>({"Merchant ID":e.merchant_id||"","\u0627\u0644\u0645\u062d\u0627\u0641\u0638\u0629":e.governorate||"","\u0627\u0644\u0648\u0632\u0627\u0631\u0629":e.ministry||"","\u0627\u0633\u0645 \u0627\u0644\u0645\u062f\u064a\u0631\u064a\u0629":e.directorate_name||"","\u0627\u0644\u062a\u0641\u0627\u0635\u064a\u0644":e.details||"","\u0639\u062f\u062f \u0627\u0644\u0623\u062c\u0647\u0632\u0629":e.device_count||0,IBAN:e.iban||"","\u0631\u0642\u0645 \u0627\u0644\u062d\u0633\u0627\u0628":e.account_number||"","\u0627\u0633\u0645 \u0627\u0644\u0641\u0631\u0639":e.branch_name||"","\u0631\u0642\u0645 \u0627\u0644\u0641\u0631\u0639":e.branch_number||"","\u0643\u0648\u062f \u0627\u0644\u0645\u0635\u0631\u0641":e.bank_code||"","\u0627\u0633\u0645 \u0627\u0644\u0645\u0635\u0631\u0641":e.bank_name||"","\u0627\u0633\u0645 \u0627\u0644\u062a\u0633\u0648\u064a\u0629":e.settlement_name||"","\u0646\u0648\u0639 \u0627\u0644\u0639\u0645\u0648\u0644\u0629 / \u0627\u0644\u0642\u0637\u0627\u0639":e.commission_type||""})),c=C.Wp.book_new(),i=C.Wp.json_to_sheet(o(n));if(C.Wp.book_append_sheet(c,i,"\u0627\u0644\u0643\u0644"),r.length>0){const e=C.Wp.json_to_sheet(o(r));C.Wp.book_append_sheet(c,e,"\u062d\u0643\u0648\u0645\u064a")}if(l.length>0){const e=C.Wp.json_to_sheet(o(l));C.Wp.book_append_sheet(c,e,"\u062e\u0627\u0635")}const d=(new Date).toISOString().slice(0,10);C._h(c,"merchants_".concat(d,".xlsx")),O({title:"\u0646\u062c\u062d",description:"\u062a\u0645 \u062a\u0635\u062f\u064a\u0631 ".concat(n.length," \u062a\u0627\u062c\u0631 \u0625\u0644\u0649 Excel (\u062d\u0633\u0628 \u0627\u0644\u0641\u0644\u0627\u062a\u0631 \u0627\u0644\u062d\u0627\u0644\u064a\u0629)"),variant:"success"})}catch(t){console.error("Export error:",t),O({title:"\u062e\u0637\u0623",description:"\u062d\u062f\u062b \u062e\u0637\u0623 \u0623\u062b\u0646\u0627\u0621 \u062a\u0635\u062f\u064a\u0631 \u0627\u0644\u0628\u064a\u0627\u0646\u0627\u062a \u0625\u0644\u0649 Excel",variant:"destructive"})}},className:"ds-btn ds-btn-outline px-4 py-2 rounded-full text-sm font-medium bg-white text-[#026174] border-0 shadow",children:"\u062a\u0635\u062f\u064a\u0631 \u0625\u0644\u0649 Excel"}),R&&(0,N.jsx)("button",{type:"button",onClick:()=>V(!0),className:"ds-btn ds-btn-primary px-4 py-2 rounded-full text-sm font-medium",children:"\u0627\u0633\u062a\u064a\u0631\u0627\u062f \u0645\u0646 Excel"}),K&&(0,N.jsx)("button",{type:"button",onClick:()=>{se(),q(!0)},className:"ds-btn ds-btn-primary px-4 py-2 rounded-full text-sm font-medium bg-white text-[#026174] border-0 shadow hover:bg-white/95",children:"\u0625\u0636\u0627\u0641\u0629 \u062a\u0627\u062c\u0631 \u062c\u062f\u064a\u062f"})]})]}),(0,N.jsx)("div",{className:"grid gap-4 mb-6",style:{gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))"},children:[{label:"\u0625\u062c\u0645\u0627\u0644\u064a \u0627\u0644\u062a\u062c\u0627\u0631",value:ce.total,Icon:m.A,bg:"linear-gradient(135deg, #eef9fb 0%, #e4f4f7 100%)",border:"#026174",iconBg:"linear-gradient(135deg, #068294 0%, #026174 100%)",textColor:"#026174"},{label:"\u062a\u062c\u0627\u0631 \u0627\u0644\u0642\u0637\u0627\u0639 \u0627\u0644\u062d\u0643\u0648\u0645\u064a",value:ce.govCount,Icon:x.A,bg:"linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%)",border:"#16a34a",iconBg:"linear-gradient(135deg, #16a34a 0%, #15803d 100%)",textColor:"#15803d"},{label:"\u062a\u062c\u0627\u0631 \u0627\u0644\u0642\u0637\u0627\u0639 \u0627\u0644\u062e\u0627\u0635",value:ce.privateCount,Icon:u.A,bg:"linear-gradient(135deg, #fff7ed 0%, #ffedd5 100%)",border:"#ea580c",iconBg:"linear-gradient(135deg, #ea580c 0%, #c2410c 100%)",textColor:"#c2410c"},{label:"\u0639\u062f\u062f \u0627\u0644\u0645\u062d\u0627\u0641\u0638\u0627\u062a \u0627\u0644\u0645\u063a\u0637\u0651\u0627\u0629",value:ce.uniqueGovernorates,Icon:h.A,bg:"linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%)",border:"#0284c7",iconBg:"linear-gradient(135deg, #0284c7 0%, #0369a1 100%)",textColor:"#0369a1"}].map((e,t)=>(0,N.jsx)("div",{className:"rounded-2xl p-5 border-2 relative overflow-hidden transition-all hover:shadow-lg hover:-translate-y-0.5",style:{background:e.bg,borderColor:e.border,boxShadow:"0 4px 20px rgba(0,0,0,0.06)"},children:(0,N.jsxs)("div",{className:"flex items-center gap-3",children:[(0,N.jsx)("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center flex-shrink-0",style:{background:e.iconBg},children:(0,N.jsx)(e.Icon,{className:"w-6 h-6 text-white",strokeWidth:2.5})}),(0,N.jsxs)("div",{children:[(0,N.jsx)("p",{className:"text-xs font-bold m-0 mb-0.5",style:{color:"var(--text-muted)"},children:e.label}),(0,N.jsx)("p",{className:"text-2xl font-extrabold m-0 tabular-nums",style:{color:e.textColor},dir:"ltr",children:e.value})]})]})},t))}),(0,N.jsxs)("div",{className:"rounded-2xl p-5 mb-6 merchants-filter-card",style:{background:"linear-gradient(180deg, #eef9fb 0%, #ffffff 100%)",boxShadow:"0 6px 24px rgba(2, 97, 116, 0.12)",border:"2px solid #b8dce2"},children:[(0,N.jsxs)("div",{className:"flex items-center justify-between gap-4 flex-wrap mb-4",children:[(0,N.jsxs)("div",{className:"flex items-center gap-2",children:[(0,N.jsx)("div",{className:"w-9 h-9 rounded-lg flex items-center justify-center",style:{background:"linear-gradient(135deg, #026174 0%, #068294 100%)"},children:(0,N.jsx)(d.A,{className:"w-5 h-5 text-white",strokeWidth:2.5})}),(0,N.jsx)("span",{className:"text-base font-bold",style:{color:"#026174"},children:"\u0627\u0644\u0641\u0644\u0627\u062a\u0631 \u2014 \u0625\u062f\u0627\u0631\u0629 \u0627\u0644\u062a\u062c\u0627\u0631"})]}),(0,N.jsx)("button",{type:"button",onClick:()=>{E({search:"",governorate:"",ministry:"",bank_code:"",commission_type:""}),W({merchant_id:"",governorate:"",ministry:"",directorate_name:"",bank_code:"",settlement_name:"",commission_type:"",device_count:"",iban:"",account_number:"",branch_name:""}),B({column:null,direction:null}),I(e=>(0,s.A)((0,s.A)({},e),{},{page:1}))},disabled:!ie,className:"merchants-clear-filters-btn",children:"\u0645\u0633\u062d \u0627\u0644\u0641\u0644\u0627\u062a\u0631"})]}),(0,N.jsxs)("div",{className:"grid gap-4",style:{gridTemplateColumns:"minmax(240px, 2fr) repeat(auto-fit, minmax(160px, 1fr))"},children:[(0,N.jsxs)("div",{className:"merchants-filter-input-wrapper",children:[(0,N.jsx)(b.A,{className:"w-5 h-5 text-[#026174] flex-shrink-0",strokeWidth:2}),(0,N.jsx)("input",{type:"text",placeholder:"\u0628\u062d\u062b \u0628\u0627\u0633\u0645 \u0627\u0644\u0645\u062f\u064a\u0631\u064a\u0629 / Merchant ID / IBAN...",value:D.search,onChange:e=>re("search",e.target.value),className:"merchants-filter-input"})]}),(0,N.jsxs)("div",{className:"merchants-filter-select-wrapper",children:[(0,N.jsx)(h.A,{className:"w-4 h-4 text-[#026174] flex-shrink-0",strokeWidth:2}),(0,N.jsxs)("select",{value:D.governorate,onChange:e=>re("governorate",e.target.value),className:"merchants-filter-select",children:[(0,N.jsx)("option",{value:"",children:"\u062c\u0645\u064a\u0639 \u0627\u0644\u0645\u062d\u0627\u0641\u0638\u0627\u062a"}),null===(e=M.governorates)||void 0===e?void 0:e.map(e=>(0,N.jsx)("option",{value:e,children:e},e))]})]}),(0,N.jsxs)("div",{className:"merchants-filter-select-wrapper",children:[(0,N.jsx)(x.A,{className:"w-4 h-4 text-[#026174] flex-shrink-0",strokeWidth:2}),(0,N.jsxs)("select",{value:D.ministry,onChange:e=>re("ministry",e.target.value),className:"merchants-filter-select",children:[(0,N.jsx)("option",{value:"",children:"\u062c\u0645\u064a\u0639 \u0627\u0644\u0648\u0632\u0627\u0631\u0627\u062a"}),null===(t=M.ministries)||void 0===t?void 0:t.map(e=>(0,N.jsx)("option",{value:e,children:e},e))]})]}),(0,N.jsxs)("div",{className:"merchants-filter-select-wrapper",children:[(0,N.jsx)(p.A,{className:"w-4 h-4 text-[#026174] flex-shrink-0",strokeWidth:2}),(0,N.jsxs)("select",{value:D.bank_code,onChange:e=>re("bank_code",e.target.value),className:"merchants-filter-select",children:[(0,N.jsx)("option",{value:"",children:"\u062c\u0645\u064a\u0639 \u0627\u0644\u0645\u0635\u0627\u0631\u0641"}),null===(n=M.bankCodes)||void 0===n?void 0:n.map(e=>(0,N.jsx)("option",{value:e,children:e},e))]})]}),(0,N.jsxs)("div",{className:"merchants-filter-select-wrapper",children:[(0,N.jsx)(g.A,{className:"w-4 h-4 text-[#026174] flex-shrink-0",strokeWidth:2}),(0,N.jsxs)("select",{value:D.commission_type,onChange:e=>re("commission_type",e.target.value),className:"merchants-filter-select",children:[(0,N.jsx)("option",{value:"",children:"\u0643\u0644 \u0627\u0644\u0642\u0637\u0627\u0639\u0627\u062a"}),(0,N.jsx)("option",{value:"\u062d\u0643\u0648\u0645\u064a",children:"\u062d\u0643\u0648\u0645\u064a"}),(0,N.jsx)("option",{value:"\u062e\u0627\u0635",children:"\u062e\u0627\u0635"})]})]})]})]}),j&&0===i.length&&(0,N.jsx)("div",{className:"p-16 flex justify-center",children:(0,N.jsx)(c.A,{message:"\u062c\u0627\u0631\u064a \u062a\u062d\u0645\u064a\u0644 \u0627\u0644\u062a\u062c\u0627\u0631..."})}),!j&&(0,N.jsxs)("div",{className:"rounded-2xl overflow-hidden merchants-table-container",style:{background:"var(--surface)",boxShadow:"var(--shadow-card)",border:"2px solid var(--border-card)"},children:[(0,N.jsx)("div",{className:"merchants-table-scroll overflow-x-auto",style:{isolation:"isolate"},children:0===i.length?(0,N.jsxs)("div",{className:"p-16 text-center",children:[(0,N.jsx)("p",{className:"text-lg font-bold m-0",style:{color:"var(--text-strong)"},children:"\u0644\u0627 \u062a\u0648\u062c\u062f \u062a\u062c\u0627\u0631 \u0645\u0637\u0627\u0628\u0642\u0629 \u0644\u0645\u0639\u0627\u064a\u064a\u0631 \u0627\u0644\u0628\u062d\u062b \u0627\u0644\u062d\u0627\u0644\u064a\u0629"}),(0,N.jsxs)("p",{className:"mt-2 text-sm m-0",style:{color:"var(--text-muted)"},children:["\u062c\u0631\u0651\u0628 \u062a\u0639\u062f\u064a\u0644 \u0627\u0644\u0641\u0644\u0627\u062a\u0631 \u0623\u0648"," ",(0,N.jsx)("button",{type:"button",onClick:()=>{E({search:"",governorate:"",ministry:"",bank_code:"",commission_type:""}),W({merchant_id:"",governorate:"",ministry:"",directorate_name:"",bank_code:"",settlement_name:"",commission_type:"",device_count:"",iban:"",account_number:"",branch_name:""}),B({column:null,direction:null}),I(e=>(0,s.A)((0,s.A)({},e),{},{page:1}))},className:"text-[var(--primary-600)] cursor-pointer underline bg-transparent border-0 text-sm",children:"\u0645\u0633\u062d \u062c\u0645\u064a\u0639 \u0627\u0644\u0641\u0644\u0627\u062a\u0631"})]})]}):(0,N.jsxs)("table",{className:"ds-table w-full border-collapse text-sm merchants-table-sticky",dir:"rtl",style:{minWidth:"1600px"},children:[(0,N.jsxs)("thead",{children:[(0,N.jsxs)("tr",{className:"table-header-dark merchants-sticky-header-row",style:{background:"linear-gradient(135deg, #026174 0%, #068294 100%)"},children:[(0,N.jsx)("th",{className:"text-end py-4 px-4 font-bold text-white",children:(0,N.jsx)(A,{children:"Merchant ID"})}),(0,N.jsx)("th",{className:"text-end py-4 px-4 font-bold text-white",children:(0,N.jsx)(A,{children:"\u0627\u0644\u0645\u062d\u0627\u0641\u0638\u0629"})}),(0,N.jsx)("th",{className:"text-end py-4 px-4 font-bold text-white",children:(0,N.jsx)(A,{children:"\u0627\u0644\u0648\u0632\u0627\u0631\u0629"})}),(0,N.jsx)("th",{className:"text-end py-4 px-4 font-bold text-white",children:(0,N.jsx)(A,{children:"\u0627\u0633\u0645 \u0627\u0644\u0645\u062f\u064a\u0631\u064a\u0629"})}),(0,N.jsx)("th",{className:"text-end py-4 px-4 font-bold text-white",children:(0,N.jsx)(A,{children:"\u0627\u0644\u062a\u0641\u0627\u0635\u064a\u0644"})}),(0,N.jsx)("th",{className:"text-end py-4 px-4 font-bold text-white",children:(0,N.jsx)(A,{children:"\u0627\u0644\u0645\u0635\u0631\u0641"})}),(0,N.jsx)("th",{className:"text-end py-4 px-4 font-bold text-white",children:(0,N.jsx)(A,{children:"\u0627\u0633\u0645 \u0627\u0644\u062a\u0633\u0648\u064a\u0629"})}),(0,N.jsx)("th",{className:"text-end py-4 px-4 font-bold text-white",children:(0,N.jsx)(A,{children:"\u0646\u0648\u0639 \u0627\u0644\u0642\u0637\u0627\u0639"})}),(0,N.jsx)("th",{className:"text-center py-4 px-4 font-bold text-white",children:(0,N.jsx)(A,{children:"\u0639\u062f\u062f \u0627\u0644\u0623\u062c\u0647\u0632\u0629"})}),(0,N.jsx)("th",{className:"text-end py-4 px-4 font-bold text-white",children:(0,N.jsx)(A,{children:"IBAN"})}),(0,N.jsx)("th",{className:"text-end py-4 px-4 font-bold text-white",children:(0,N.jsx)(A,{children:"\u0631\u0642\u0645 \u0627\u0644\u062d\u0633\u0627\u0628"})}),(0,N.jsx)("th",{className:"text-end py-4 px-4 font-bold text-white",children:(0,N.jsx)(A,{children:"\u0627\u0633\u0645 \u0627\u0644\u0641\u0631\u0639"})}),(0,N.jsx)("th",{className:"text-center py-4 px-4 font-bold text-white",children:"\u0627\u0644\u0625\u062c\u0631\u0627\u0621\u0627\u062a"})]}),(0,N.jsxs)("tr",{className:"excel-filter-row merchants-sticky-filter-row",children:[(0,N.jsx)("th",{className:"excel-filter-cell",children:(0,N.jsx)(w,{columnKey:"merchant_id",columnLabel:"Merchant ID",options:M.merchantIds||[],value:L.merchant_id||D.search,onChange:e=>{W(t=>(0,s.A)((0,s.A)({},t),{},{merchant_id:e})),E(t=>{var n;return(0,s.A)((0,s.A)({},t),{},{search:(null===(n=(e||"").split(",")[0])||void 0===n?void 0:n.trim())||""})}),I(e=>(0,s.A)((0,s.A)({},e),{},{page:1}))},sortDirection:"merchant_id"===T.column?T.direction:null,onSortChange:e=>le(e?"merchant_id":null,e),trigger:(0,N.jsx)(S,{value:L.merchant_id||D.search,label:"\u0627\u0644\u0643\u0644"})})}),(0,N.jsx)("th",{className:"excel-filter-cell",children:(0,N.jsx)(w,{columnKey:"governorate",columnLabel:"\u0627\u0644\u0645\u062d\u0627\u0641\u0638\u0629",options:M.governorates||[],value:L.governorate||D.governorate,onChange:e=>ae("governorate",e),sortDirection:"governorate"===T.column?T.direction:null,onSortChange:e=>le(e?"governorate":null,e),trigger:(0,N.jsx)(S,{value:L.governorate||D.governorate,label:"\u0627\u0644\u0643\u0644"})})}),(0,N.jsx)("th",{className:"excel-filter-cell",children:(0,N.jsx)(w,{columnKey:"ministry",columnLabel:"\u0627\u0644\u0648\u0632\u0627\u0631\u0629",options:M.ministries||[],value:L.ministry||D.ministry,onChange:e=>ae("ministry",e),sortDirection:"ministry"===T.column?T.direction:null,onSortChange:e=>le(e?"ministry":null,e),trigger:(0,N.jsx)(S,{value:L.ministry||D.ministry,label:"\u0627\u0644\u0643\u0644"})})}),(0,N.jsx)("th",{className:"excel-filter-cell",children:(0,N.jsx)(w,{columnKey:"directorate_name",columnLabel:"\u0627\u0633\u0645 \u0627\u0644\u0645\u062f\u064a\u0631\u064a\u0629",options:M.directorates||[],value:L.directorate_name,onChange:e=>ae("directorate_name",e),sortDirection:"directorate_name"===T.column?T.direction:null,onSortChange:e=>le(e?"directorate_name":null,e),trigger:(0,N.jsx)(S,{value:L.directorate_name,label:"\u0627\u0644\u0643\u0644"})})}),(0,N.jsx)("th",{className:"excel-filter-cell"}),(0,N.jsx)("th",{className:"excel-filter-cell",children:(0,N.jsx)(w,{columnKey:"bank_code",columnLabel:"\u0627\u0644\u0645\u0635\u0631\u0641",options:M.bankCodes||[],value:L.bank_code||D.bank_code,onChange:e=>ae("bank_code",e),sortDirection:"bank_code"===T.column?T.direction:null,onSortChange:e=>le(e?"bank_code":null,e),trigger:(0,N.jsx)(S,{value:L.bank_code||D.bank_code,label:"\u0627\u0644\u0643\u0644"})})}),(0,N.jsx)("th",{className:"excel-filter-cell",children:(0,N.jsx)(w,{columnKey:"settlement_name",columnLabel:"\u0627\u0633\u0645 \u0627\u0644\u062a\u0633\u0648\u064a\u0629",options:M.settlements||[],value:L.settlement_name,onChange:e=>ae("settlement_name",e),sortDirection:"settlement_name"===T.column?T.direction:null,onSortChange:e=>le(e?"settlement_name":null,e),trigger:(0,N.jsx)(S,{value:L.settlement_name,label:"\u0627\u0644\u0643\u0644"})})}),(0,N.jsx)("th",{className:"excel-filter-cell",children:(0,N.jsx)(w,{columnKey:"commission_type",columnLabel:"\u0646\u0648\u0639 \u0627\u0644\u0642\u0637\u0627\u0639",options:["\u062d\u0643\u0648\u0645\u064a","\u062e\u0627\u0635"],value:L.commission_type||D.commission_type,onChange:e=>ae("commission_type",e),sortDirection:"commission_type"===T.column?T.direction:null,onSortChange:e=>le(e?"commission_type":null,e),trigger:(0,N.jsx)(S,{value:L.commission_type||D.commission_type,label:"\u0627\u0644\u0643\u0644"})})}),(0,N.jsx)("th",{className:"excel-filter-cell",children:(0,N.jsx)(w,{columnKey:"device_count",columnLabel:"\u0639\u062f\u062f \u0627\u0644\u0623\u062c\u0647\u0632\u0629",options:M.deviceCounts||[],value:L.device_count,onChange:e=>ae("device_count",e),sortDirection:"device_count"===T.column?T.direction:null,onSortChange:e=>le(e?"device_count":null,e),trigger:(0,N.jsx)(S,{value:L.device_count,label:"\u0627\u0644\u0643\u0644"})})}),(0,N.jsx)("th",{className:"excel-filter-cell",children:(0,N.jsx)(w,{columnKey:"iban",columnLabel:"IBAN",options:M.ibans||[],value:L.iban,onChange:e=>ae("iban",e),sortDirection:"iban"===T.column?T.direction:null,onSortChange:e=>le(e?"iban":null,e),trigger:(0,N.jsx)(S,{value:L.iban,label:"\u0627\u0644\u0643\u0644"})})}),(0,N.jsx)("th",{className:"excel-filter-cell",children:(0,N.jsx)(w,{columnKey:"account_number",columnLabel:"\u0631\u0642\u0645 \u0627\u0644\u062d\u0633\u0627\u0628",options:M.accountNumbers||[],value:L.account_number,onChange:e=>ae("account_number",e),sortDirection:"account_number"===T.column?T.direction:null,onSortChange:e=>le(e?"account_number":null,e),trigger:(0,N.jsx)(S,{value:L.account_number,label:"\u0627\u0644\u0643\u0644"})})}),(0,N.jsx)("th",{className:"excel-filter-cell",children:(0,N.jsx)(w,{columnKey:"branch_name",columnLabel:"\u0627\u0633\u0645 \u0627\u0644\u0641\u0631\u0639",options:M.branches||[],value:L.branch_name,onChange:e=>ae("branch_name",e),sortDirection:"branch_name"===T.column?T.direction:null,onSortChange:e=>le(e?"branch_name":null,e),trigger:(0,N.jsx)(S,{value:L.branch_name,label:"\u0627\u0644\u0643\u0644"})})}),(0,N.jsx)("th",{className:"excel-filter-cell"})]})]}),(0,N.jsx)("tbody",{children:0===oe.length?(0,N.jsx)("tr",{children:(0,N.jsx)("td",{colSpan:13,className:"py-8 text-center",style:{color:"var(--text-muted)"},children:"\u0644\u0627 \u062a\u0648\u062c\u062f \u0635\u0641\u0648\u0641 \u0645\u0637\u0627\u0628\u0642\u0629 \u0644\u0644\u0641\u0644\u0627\u062a\u0631"})}):oe.map((e,t)=>{const n="\u062d\u0643\u0648\u0645\u064a"===e.commission_type;return(0,N.jsxs)("tr",{className:"".concat(t%2===0?"bg-white":"bg-slate-50/50"," hover:bg-slate-50/80 transition-colors"),style:{borderBottom:"1px solid var(--border)"},children:[(0,N.jsx)("td",{className:"py-3 px-4",style:{color:"var(--text)"},children:e.merchant_id}),(0,N.jsx)("td",{className:"py-3 px-4",style:{color:"var(--text)"},children:e.governorate||"-"}),(0,N.jsx)("td",{className:"py-3 px-4",style:{color:"var(--text)"},children:e.ministry||"-"}),(0,N.jsx)("td",{className:"py-3 px-4 max-w-[260px]",style:{color:"var(--text)"},children:e.directorate_name||"-"}),(0,N.jsx)("td",{className:"py-3 px-4 max-w-[220px] truncate",style:{color:"var(--text)"},title:e.details||void 0,children:e.details||"-"}),(0,N.jsx)("td",{className:"py-3 px-4",style:{color:"var(--text)"},children:e.bank_name||e.bank_code||"-"}),(0,N.jsx)("td",{className:"py-3 px-4 max-w-[260px]",style:{color:"var(--text)"},children:e.settlement_name||"-"}),(0,N.jsx)("td",{className:"py-3 px-4 font-semibold",style:{color:n?"var(--success)":"#b45309"},children:e.commission_type||"-"}),(0,N.jsx)("td",{className:"py-3 px-4 text-center",style:{color:"var(--text)"},children:e.device_count||0}),(0,N.jsx)("td",{className:"py-3 px-4 font-mono text-sm",style:{color:"var(--text)"},dir:"ltr",children:e.iban||"-"}),(0,N.jsx)("td",{className:"py-3 px-4",style:{color:"var(--text)"},children:e.account_number||"-"}),(0,N.jsx)("td",{className:"py-3 px-4",style:{color:"var(--text)"},children:e.branch_name||"-"}),(0,N.jsx)("td",{className:"py-3 px-4",children:(0,N.jsxs)("div",{className:"flex justify-center gap-2",children:[(0,N.jsx)("button",{type:"button",onClick:()=>(e=>{H(e),ee({merchant_id:e.merchant_id||"",governorate:e.governorate||"",ministry:e.ministry||"",directorate_name:e.directorate_name||"",details:e.details||"",device_count:e.device_count||0,iban:e.iban||"",account_key:e.account_key||"",account_number:e.account_number||"",branch_name:e.branch_name||"",branch_number:e.branch_number||"",bank_code:e.bank_code||"",bank_name:e.bank_name||"",bank_name_alt:e.bank_name_alt||"",iban_length_check:e.iban_length_check||23,notes:e.notes||"",settlement_name:e.settlement_name||"",commission_type:e.commission_type||"\u062d\u0643\u0648\u0645\u064a"}),q(!0)})(e),className:"ds-btn ds-btn-primary px-3 py-1.5 rounded-lg text-sm",children:"\u062a\u0639\u062f\u064a\u0644"}),(0,N.jsx)("button",{type:"button",onClick:()=>(async e=>{if(window.confirm("\u0647\u0644 \u0623\u0646\u062a \u0645\u062a\u0623\u0643\u062f \u0645\u0646 \u062d\u0630\u0641 \u0647\u0630\u0627 \u0627\u0644\u062a\u0627\u062c\u0631\u061f"))try{await a.A.delete("/merchants/".concat(e)),O({title:"\u0646\u062c\u062d",description:"\u062a\u0645 \u062d\u0630\u0641 \u0627\u0644\u062a\u0627\u062c\u0631 \u0628\u0646\u062c\u0627\u062d",variant:"success"}),te()}catch(s){var t,n;O({title:"\u062e\u0637\u0623",description:(null===(t=s.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.error)||"\u062d\u062f\u062b \u062e\u0637\u0623",variant:"destructive"})}})(e.id),className:"px-3 py-1.5 rounded-lg text-sm font-medium bg-red-100 text-red-700 hover:bg-red-200 border-0 cursor-pointer",children:"\u062d\u0630\u0641"})]})})]},e.id)})})]})}),k.totalPages>1&&(0,N.jsxs)("div",{className:"px-4 py-3 border-t flex justify-between items-center text-sm",style:{borderColor:"var(--border-card)",background:"linear-gradient(180deg, #f8fafc 0%, #f1f5f9 100%)"},children:[(0,N.jsxs)("span",{style:{color:"var(--text-muted)"},dir:"ltr",children:["\u0627\u0644\u0635\u0641\u062d\u0629 ",k.page," \u0645\u0646 ",k.totalPages," \u2013 \u0625\u062c\u0645\u0627\u0644\u064a ",k.total," \u062a\u0627\u062c\u0631"]}),(0,N.jsxs)("div",{className:"flex gap-2",children:[(0,N.jsx)("button",{type:"button",onClick:()=>I(e=>(0,s.A)((0,s.A)({},e),{},{page:e.page-1})),disabled:1===k.page,className:"ds-btn ds-btn-outline px-3 py-2 rounded-lg disabled:opacity-50",children:"\u0627\u0644\u0633\u0627\u0628\u0642"}),(0,N.jsx)("button",{type:"button",onClick:()=>I(e=>(0,s.A)((0,s.A)({},e),{},{page:e.page+1})),disabled:k.page===k.totalPages,className:"ds-btn ds-btn-outline px-3 py-2 rounded-lg disabled:opacity-50",children:"\u0627\u0644\u062a\u0627\u0644\u064a"})]})]})]}),U&&(0,N.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 backdrop-blur-md animate-in fade-in duration-200",style:{background:"rgba(2, 97, 116, 0.15)"},children:(0,N.jsxs)("div",{className:"rounded-2xl shadow-2xl max-w-3xl w-full max-h-[90vh] overflow-hidden flex flex-col animate-in zoom-in-95 duration-200",style:{background:"var(--surface)",border:"2px solid var(--border-card)",boxShadow:"0 25px 50px -12px rgba(2, 97, 116, 0.25)"},children:[(0,N.jsxs)("div",{className:"flex items-center justify-between px-6 py-5 rounded-t-2xl shrink-0",style:{background:"linear-gradient(135deg, #026174 0%, #068294 100%)"},children:[(0,N.jsxs)("h2",{className:"text-xl font-bold m-0 text-white flex items-center gap-3",children:[(0,N.jsx)("span",{className:"w-10 h-10 rounded-xl flex items-center justify-center",style:{background:"rgba(255,255,255,0.2)"},children:(0,N.jsx)(x.A,{className:"w-5 h-5 text-white"})}),G?"\u062a\u0639\u062f\u064a\u0644 \u062a\u0627\u062c\u0631":"\u0625\u0636\u0627\u0641\u0629 \u062a\u0627\u062c\u0631 \u062c\u062f\u064a\u062f"]}),(0,N.jsx)("button",{type:"button",onClick:()=>{q(!1),se()},className:"w-10 h-10 rounded-xl flex items-center justify-center text-white hover:bg-white/20 transition-colors","aria-label":"\u0625\u063a\u0644\u0627\u0642",children:(0,N.jsx)(v.A,{className:"w-5 h-5"})})]}),(0,N.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{G?(await a.A.put("/merchants/".concat(G.id),$),O({title:"\u0646\u062c\u062d",description:"\u062a\u0645 \u062a\u062d\u062f\u064a\u062b \u0627\u0644\u062a\u0627\u062c\u0631 \u0628\u0646\u062c\u0627\u062d",variant:"success"})):(await a.A.post("/merchants",$),O({title:"\u0646\u062c\u062d",description:"\u062a\u0645 \u0625\u0636\u0627\u0641\u0629 \u0627\u0644\u062a\u0627\u062c\u0631 \u0628\u0646\u062c\u0627\u062d",variant:"success"})),q(!1),se(),te()}catch(s){var t,n;O({title:"\u062e\u0637\u0623",description:(null===(t=s.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.error)||"\u062d\u062f\u062b \u062e\u0637\u0623",variant:"destructive"})}},className:"flex flex-col flex-1 min-h-0 overflow-y-auto",children:[(0,N.jsxs)("div",{className:"p-6 space-y-6",children:[(0,N.jsxs)("div",{className:"rounded-xl p-5 border-2",style:{borderColor:"var(--border-card)",background:"linear-gradient(180deg, #fafbfc 0%, #ffffff 100%)"},children:[(0,N.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,N.jsx)(x.A,{className:"w-5 h-5",style:{color:"var(--primary-600)"}}),(0,N.jsx)("h3",{className:"text-base font-bold m-0",style:{color:"var(--text-strong)"},children:"\u0627\u0644\u0628\u064a\u0627\u0646\u0627\u062a \u0627\u0644\u0623\u0633\u0627\u0633\u064a\u0629"})]}),(0,N.jsxs)("div",{className:"grid gap-4",style:{gridTemplateColumns:"repeat(2, 1fr)"},children:[(0,N.jsxs)("div",{children:[(0,N.jsxs)("label",{className:"block text-sm font-semibold mb-1.5",style:{color:"var(--text-strong)"},children:["Merchant ID ",(0,N.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,N.jsx)("input",{type:"text",required:!0,value:$.merchant_id,onChange:e=>ee((0,s.A)((0,s.A)({},$),{},{merchant_id:e.target.value})),className:"ds-input w-full py-2.5 px-4 rounded-xl border-2 focus:border-[#026174] focus:ring-2 focus:ring-[#026174]/20 transition-all",placeholder:"\u0645\u062b\u0627\u0644: GOVEDU111111111"})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:"block text-sm font-semibold mb-1.5",style:{color:"var(--text-strong)"},children:"\u0627\u0644\u0645\u062d\u0627\u0641\u0638\u0629"}),(0,N.jsx)("input",{type:"text",value:$.governorate,onChange:e=>ee((0,s.A)((0,s.A)({},$),{},{governorate:e.target.value})),className:"ds-input w-full py-2.5 px-4 rounded-xl border-2 focus:border-[#026174] focus:ring-2 focus:ring-[#026174]/20 transition-all"})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:"block text-sm font-semibold mb-1.5",style:{color:"var(--text-strong)"},children:"\u0627\u0644\u0648\u0632\u0627\u0631\u0629"}),(0,N.jsx)("input",{type:"text",value:$.ministry,onChange:e=>ee((0,s.A)((0,s.A)({},$),{},{ministry:e.target.value})),className:"ds-input w-full py-2.5 px-4 rounded-xl border-2 focus:border-[#026174] focus:ring-2 focus:ring-[#026174]/20 transition-all"})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:"block text-sm font-semibold mb-1.5",style:{color:"var(--text-strong)"},children:"\u0627\u0633\u0645 \u0627\u0644\u0645\u062f\u064a\u0631\u064a\u0629"}),(0,N.jsx)("input",{type:"text",value:$.directorate_name,onChange:e=>ee((0,s.A)((0,s.A)({},$),{},{directorate_name:e.target.value})),className:"ds-input w-full py-2.5 px-4 rounded-xl border-2 focus:border-[#026174] focus:ring-2 focus:ring-[#026174]/20 transition-all"})]}),(0,N.jsxs)("div",{className:"col-span-2",children:[(0,N.jsx)("label",{className:"block text-sm font-semibold mb-1.5",style:{color:"var(--text-strong)"},children:"\u0627\u0644\u062a\u0641\u0627\u0635\u064a\u0644"}),(0,N.jsx)("textarea",{value:$.details,onChange:e=>ee((0,s.A)((0,s.A)({},$),{},{details:e.target.value})),className:"ds-input w-full py-2.5 px-4 rounded-xl min-h-[88px] border-2 focus:border-[#026174] focus:ring-2 focus:ring-[#026174]/20 transition-all resize-none",rows:3})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:"block text-sm font-semibold mb-1.5",style:{color:"var(--text-strong)"},children:"\u0639\u062f\u062f \u0627\u0644\u0623\u062c\u0647\u0632\u0629"}),(0,N.jsx)("input",{type:"number",min:0,value:$.device_count,onChange:e=>ee((0,s.A)((0,s.A)({},$),{},{device_count:parseInt(e.target.value)||0})),className:"ds-input w-full py-2.5 px-4 rounded-xl border-2 focus:border-[#026174] focus:ring-2 focus:ring-[#026174]/20 transition-all",dir:"ltr"})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:"block text-sm font-semibold mb-1.5",style:{color:"var(--text-strong)"},children:"\u0646\u0648\u0639 \u0627\u0644\u0639\u0645\u0648\u0644\u0629"}),(0,N.jsxs)("select",{value:$.commission_type,onChange:e=>ee((0,s.A)((0,s.A)({},$),{},{commission_type:e.target.value})),className:"ds-input w-full py-2.5 px-4 rounded-xl border-2 focus:border-[#026174] focus:ring-2 focus:ring-[#026174]/20 transition-all",children:[(0,N.jsx)("option",{value:"\u062d\u0643\u0648\u0645\u064a",children:"\u062d\u0643\u0648\u0645\u064a"}),(0,N.jsx)("option",{value:"\u062e\u0627\u0635",children:"\u062e\u0627\u0635"})]})]})]})]}),(0,N.jsxs)("div",{className:"rounded-xl p-5 border-2",style:{borderColor:"var(--border-card)",background:"linear-gradient(180deg, #fafbfc 0%, #ffffff 100%)"},children:[(0,N.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,N.jsx)(p.A,{className:"w-5 h-5",style:{color:"var(--primary-600)"}}),(0,N.jsx)("h3",{className:"text-base font-bold m-0",style:{color:"var(--text-strong)"},children:"\u0627\u0644\u0628\u064a\u0627\u0646\u0627\u062a \u0627\u0644\u0645\u0635\u0631\u0641\u064a\u0629"})]}),(0,N.jsxs)("div",{className:"grid gap-4",style:{gridTemplateColumns:"repeat(2, 1fr)"},children:[(0,N.jsxs)("div",{className:"col-span-2",children:[(0,N.jsx)("label",{className:"block text-sm font-semibold mb-1.5",style:{color:"var(--text-strong)"},children:"IBAN"}),(0,N.jsx)("input",{type:"text",value:$.iban,onChange:e=>ee((0,s.A)((0,s.A)({},$),{},{iban:e.target.value})),className:"ds-input w-full py-2.5 px-4 rounded-xl border-2 focus:border-[#026174] focus:ring-2 focus:ring-[#026174]/20 transition-all font-mono",dir:"ltr",placeholder:"IQ..."})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:"block text-sm font-semibold mb-1.5",style:{color:"var(--text-strong)"},children:"\u0631\u0642\u0645 \u0627\u0644\u062d\u0633\u0627\u0628"}),(0,N.jsx)("input",{type:"text",value:$.account_number,onChange:e=>ee((0,s.A)((0,s.A)({},$),{},{account_number:e.target.value})),className:"ds-input w-full py-2.5 px-4 rounded-xl border-2 focus:border-[#026174] focus:ring-2 focus:ring-[#026174]/20 transition-all",dir:"ltr"})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:"block text-sm font-semibold mb-1.5",style:{color:"var(--text-strong)"},children:"\u0643\u0648\u062f \u0627\u0644\u0645\u0635\u0631\u0641"}),(0,N.jsx)("input",{type:"text",value:$.bank_code,onChange:e=>ee((0,s.A)((0,s.A)({},$),{},{bank_code:e.target.value})),className:"ds-input w-full py-2.5 px-4 rounded-xl border-2 focus:border-[#026174] focus:ring-2 focus:ring-[#026174]/20 transition-all"})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:"block text-sm font-semibold mb-1.5",style:{color:"var(--text-strong)"},children:"\u0627\u0633\u0645 \u0627\u0644\u0645\u0635\u0631\u0641"}),(0,N.jsx)("input",{type:"text",value:$.bank_name,onChange:e=>ee((0,s.A)((0,s.A)({},$),{},{bank_name:e.target.value})),className:"ds-input w-full py-2.5 px-4 rounded-xl border-2 focus:border-[#026174] focus:ring-2 focus:ring-[#026174]/20 transition-all"})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:"block text-sm font-semibold mb-1.5",style:{color:"var(--text-strong)"},children:"\u0627\u0633\u0645 \u0627\u0644\u0641\u0631\u0639"}),(0,N.jsx)("input",{type:"text",value:$.branch_name,onChange:e=>ee((0,s.A)((0,s.A)({},$),{},{branch_name:e.target.value})),className:"ds-input w-full py-2.5 px-4 rounded-xl border-2 focus:border-[#026174] focus:ring-2 focus:ring-[#026174]/20 transition-all"})]}),(0,N.jsxs)("div",{children:[(0,N.jsx)("label",{className:"block text-sm font-semibold mb-1.5",style:{color:"var(--text-strong)"},children:"\u0631\u0642\u0645 \u0627\u0644\u0641\u0631\u0639"}),(0,N.jsx)("input",{type:"text",value:$.branch_number,onChange:e=>ee((0,s.A)((0,s.A)({},$),{},{branch_number:e.target.value})),className:"ds-input w-full py-2.5 px-4 rounded-xl border-2 focus:border-[#026174] focus:ring-2 focus:ring-[#026174]/20 transition-all",dir:"ltr"})]}),(0,N.jsxs)("div",{className:"col-span-2",children:[(0,N.jsx)("label",{className:"block text-sm font-semibold mb-1.5",style:{color:"var(--text-strong)"},children:"\u0627\u0633\u0645 \u0627\u0644\u062a\u0633\u0648\u064a\u0629"}),(0,N.jsx)("input",{type:"text",value:$.settlement_name,onChange:e=>ee((0,s.A)((0,s.A)({},$),{},{settlement_name:e.target.value})),className:"ds-input w-full py-2.5 px-4 rounded-xl border-2 focus:border-[#026174] focus:ring-2 focus:ring-[#026174]/20 transition-all"})]})]})]}),(0,N.jsxs)("div",{className:"rounded-xl p-5 border-2",style:{borderColor:"var(--border-card)",background:"linear-gradient(180deg, #fafbfc 0%, #ffffff 100%)"},children:[(0,N.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,N.jsx)(f.A,{className:"w-5 h-5",style:{color:"var(--primary-600)"}}),(0,N.jsx)("h3",{className:"text-base font-bold m-0",style:{color:"var(--text-strong)"},children:"\u0645\u0644\u0627\u062d\u0638\u0627\u062a \u0625\u0636\u0627\u0641\u064a\u0629"})]}),(0,N.jsx)("textarea",{value:$.notes,onChange:e=>ee((0,s.A)((0,s.A)({},$),{},{notes:e.target.value})),className:"ds-input w-full py-2.5 px-4 rounded-xl min-h-[88px] border-2 focus:border-[#026174] focus:ring-2 focus:ring-[#026174]/20 transition-all resize-none",rows:3,placeholder:"\u0623\u064a \u0645\u0644\u0627\u062d\u0638\u0627\u062a \u0623\u0648 \u062a\u0641\u0627\u0635\u064a\u0644 \u0625\u0636\u0627\u0641\u064a\u0629..."})]})]}),(0,N.jsxs)("div",{className:"flex gap-3 justify-end px-6 py-4 border-t shrink-0",style:{borderColor:"var(--border-card)",background:"linear-gradient(180deg, #f8fafc 0%, #f1f5f9 100%)"},children:[(0,N.jsx)("button",{type:"button",onClick:()=>{q(!1),se()},className:"ds-btn ds-btn-outline px-5 py-2.5 rounded-xl font-semibold",children:"\u0625\u0644\u063a\u0627\u0621"}),(0,N.jsx)("button",{type:"submit",className:"ds-btn ds-btn-primary px-6 py-2.5 rounded-xl font-semibold shadow-lg",style:{background:"linear-gradient(135deg, #026174 0%, #068294 100%)"},children:G?"\u062a\u062d\u062f\u064a\u062b \u0627\u0644\u062a\u0627\u062c\u0631":"\u0625\u0636\u0627\u0641\u0629 \u0627\u0644\u062a\u0627\u062c\u0631"})]})]})]})}),z&&(0,N.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 backdrop-blur-sm",style:{background:"rgba(2, 97, 116, 0.2)"},children:(0,N.jsxs)("div",{className:"rounded-2xl shadow-2xl max-w-[900px] w-[90%] max-h-[90vh] overflow-y-auto",style:{background:"var(--surface)",border:"2px solid var(--border-card)"},children:[(0,N.jsx)("div",{className:"rounded-t-2xl py-4 px-6",style:{background:"linear-gradient(135deg, #026174 0%, #068294 100%)"},children:(0,N.jsx)("h2",{className:"text-xl font-bold m-0 text-white",children:"\u0627\u0633\u062a\u064a\u0631\u0627\u062f \u0628\u064a\u0627\u0646\u0627\u062a \u0627\u0644\u062a\u062c\u0627\u0631 \u0645\u0646 \u0645\u0644\u0641 Excel"})}),(0,N.jsxs)("div",{className:"p-6",children:[X?(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)("div",{className:"rounded-xl p-4 mb-6 border-2",style:{background:"var(--surface)",borderColor:"var(--success)"},children:[(0,N.jsx)("h3",{className:"text-base font-bold m-0 mb-3",style:{color:"var(--text-strong)"},children:"\u0645\u0639\u0627\u064a\u0646\u0629 \u0627\u0644\u0628\u064a\u0627\u0646\u0627\u062a:"}),(0,N.jsxs)("div",{className:"grid gap-4",style:{gridTemplateColumns:"repeat(3, 1fr)"},children:[(0,N.jsxs)("div",{className:"rounded-xl p-3 border",style:{borderColor:"var(--border-card)",background:"var(--bg)"},children:[(0,N.jsx)("p",{className:"text-xs font-bold m-0 mb-1",style:{color:"var(--text-muted)"},children:"\u0625\u062c\u0645\u0627\u0644\u064a \u0627\u0644\u0635\u0641\u0648\u0641"}),(0,N.jsx)("p",{className:"text-xl font-extrabold m-0 tabular-nums",style:{color:"var(--primary-600)"},dir:"ltr",children:X.total})]}),(0,N.jsxs)("div",{className:"rounded-xl p-3 border",style:{borderColor:"var(--border-card)",background:"var(--bg)"},children:[(0,N.jsx)("p",{className:"text-xs font-bold m-0 mb-1",style:{color:"var(--text-muted)"},children:"\u0633\u064a\u062a\u0645 \u0627\u0633\u062a\u064a\u0631\u0627\u062f\u0647\u0627"}),(0,N.jsx)("p",{className:"text-xl font-extrabold m-0 tabular-nums",style:{color:"var(--success)"},dir:"ltr",children:X.unique})]}),(0,N.jsxs)("div",{className:"rounded-xl p-3 border",style:{borderColor:"var(--border-card)",background:"var(--bg)"},children:[(0,N.jsx)("p",{className:"text-xs font-bold m-0 mb-1",style:{color:"var(--text-muted)"},children:"\u062a\u0643\u0631\u0627\u0631\u0627\u062a (\u0645\u0631\u0641\u0648\u0636\u0629)"}),(0,N.jsx)("p",{className:"text-xl font-extrabold m-0 tabular-nums text-red-600",dir:"ltr",children:X.duplicates})]})]})]}),X.merchants.length>0&&(0,N.jsxs)("div",{className:"rounded-xl overflow-hidden border-2 mb-6 max-h-[300px] overflow-y-auto",style:{borderColor:"var(--border-card)"},children:[(0,N.jsxs)("table",{className:"ds-table w-full border-collapse text-sm",children:[(0,N.jsx)("thead",{children:(0,N.jsxs)("tr",{className:"table-header-dark",style:{background:"linear-gradient(135deg, #026174 0%, #068294 100%)"},children:[(0,N.jsx)("th",{className:"text-end py-3 px-4 font-bold text-white",children:"Merchant ID"}),(0,N.jsx)("th",{className:"text-end py-3 px-4 font-bold text-white",children:"\u0627\u0644\u0645\u062d\u0627\u0641\u0638\u0629"}),(0,N.jsx)("th",{className:"text-end py-3 px-4 font-bold text-white",children:"\u0627\u0644\u0648\u0632\u0627\u0631\u0629"}),(0,N.jsx)("th",{className:"text-end py-3 px-4 font-bold text-white",children:"\u0627\u0633\u0645 \u0627\u0644\u0645\u062f\u064a\u0631\u064a\u0629"})]})}),(0,N.jsx)("tbody",{children:X.merchants.slice(0,10).map((e,t)=>{const n=e[X.headers.find(e=>e&&e.toLowerCase().includes("merchant")&&e.toLowerCase().includes("id"))||"Merchant ID"]||e["Merchant ID"]||e.merchant_id;return(0,N.jsxs)("tr",{className:t%2===0?"bg-white":"bg-slate-50/50",style:{borderBottom:"1px solid var(--border)"},children:[(0,N.jsx)("td",{className:"py-2 px-4",style:{color:"var(--text)"},children:n}),(0,N.jsx)("td",{className:"py-2 px-4",style:{color:"var(--text)"},children:e["\u0627\u0644\u0645\u062d\u0627\u0641\u0638\u0629"]||e.governorate||"-"}),(0,N.jsx)("td",{className:"py-2 px-4",style:{color:"var(--text)"},children:e["\u0627\u0644\u0648\u0632\u0627\u0631\u0629"]||e.ministry||"-"}),(0,N.jsx)("td",{className:"py-2 px-4",style:{color:"var(--text)"},children:e["\u0627\u0633\u0645 \u0627\u0644\u0645\u062f\u064a\u0631\u064a\u0629"]||e.directorate_name||"-"})]},t)})})]}),X.merchants.length>10&&(0,N.jsxs)("div",{className:"py-2 text-center text-sm",style:{color:"var(--text-muted)"},children:["... \u0648 ",X.merchants.length-10," \u0635\u0641 \u0625\u0636\u0627\u0641\u064a"]})]})]}):(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)("div",{className:"rounded-xl p-4 mb-6",style:{background:"var(--bg)",border:"1px solid var(--border-card)"},children:[(0,N.jsx)("h3",{className:"text-base font-bold m-0 mb-2",style:{color:"var(--text-strong)"},children:"\u062a\u0639\u0644\u064a\u0645\u0627\u062a \u0627\u0644\u0627\u0633\u062a\u064a\u0631\u0627\u062f:"}),(0,N.jsxs)("ul",{className:"m-0 pr-5 text-sm",style:{color:"var(--text-muted)"},children:[(0,N.jsx)("li",{children:"\u064a\u0631\u062c\u0649 \u0631\u0641\u0639 \u0645\u0644\u0641 Excel (.xlsx, .xls) \u0623\u0648 CSV"}),(0,N.jsxs)("li",{children:["\u064a\u062c\u0628 \u0623\u0646 \u064a\u062d\u062a\u0648\u064a \u0627\u0644\u0645\u0644\u0641 \u0639\u0644\u0649 \u0639\u0645\u0648\u062f ",(0,N.jsx)("strong",{children:"Merchant ID"})," (\u0645\u0639\u0631\u0641 \u0627\u0644\u062a\u0627\u062c\u0631)"]}),(0,N.jsx)("li",{children:"\u0644\u0627 \u064a\u0645\u0643\u0646 \u062a\u0643\u0631\u0627\u0631 Merchant ID - \u0633\u064a\u062a\u0645 \u0631\u0641\u0636 \u0627\u0644\u062a\u0643\u0631\u0627\u0631\u0627\u062a \u062a\u0644\u0642\u0627\u0626\u064a\u0627\u064b"}),(0,N.jsx)("li",{children:"\u0627\u0644\u0633\u0637\u0631 \u0627\u0644\u0623\u0648\u0644 \u064a\u062c\u0628 \u0623\u0646 \u064a\u062d\u062a\u0648\u064a \u0639\u0644\u0649 \u0639\u0646\u0627\u0648\u064a\u0646 \u0627\u0644\u0623\u0639\u0645\u062f\u0629"})]})]}),(0,N.jsx)("label",{className:"block text-sm font-semibold mb-2",style:{color:"var(--text-strong)"},children:"\u0627\u062e\u062a\u0631 \u0645\u0644\u0641 Excel:"}),(0,N.jsx)("input",{ref:Z,type:"file",accept:".xlsx,.xls,.csv",onChange:e=>{const t=e.target.files[0];if(!t)return;const n=t.name.split(".").pop().toLowerCase();if(!["xlsx","xls","csv"].includes(n))return void O({title:"\u062e\u0637\u0623",description:"\u064a\u0631\u062c\u0649 \u0631\u0641\u0639 \u0645\u0644\u0641 Excel (.xlsx, .xls) \u0623\u0648 CSV",variant:"destructive"});const s=new FileReader;s.onload=e=>{try{const t=new Uint8Array(e.target.result),n=C.LF(t,{type:"array"}),s=n.SheetNames[0],r=n.Sheets[s],a=C.Wp.sheet_to_json(r,{header:1,defval:""});if(a.length<2)return void O({title:"\u062e\u0637\u0623",description:"\u0627\u0644\u0645\u0644\u0641 \u0641\u0627\u0631\u063a \u0623\u0648 \u0644\u0627 \u064a\u062d\u062a\u0648\u064a \u0639\u0644\u0649 \u0628\u064a\u0627\u0646\u0627\u062a",variant:"destructive"});const l=a[0].map(e=>String(e).trim()),o=l.findIndex(e=>e&&e.toLowerCase().includes("merchant")&&e.toLowerCase().includes("id")||"Merchant ID"===e||"merchant_id"===e||"Merchant ID"===e);if(-1===o)return void O({title:"\u062e\u0637\u0623",description:"\u0644\u0645 \u064a\u062a\u0645 \u0627\u0644\u0639\u062b\u0648\u0631 \u0639\u0644\u0649 \u0639\u0645\u0648\u062f Merchant ID \u0641\u064a \u0627\u0644\u0645\u0644\u0641",variant:"destructive"});const c=a.slice(1).filter(e=>e&&e[o]).map((e,t)=>{const n={};return l.forEach((t,s)=>{const r=e[s];n[t]=void 0!==r&&null!==r?String(r).trim():""}),n._rowNumber=t+2,n});if(0===c.length)return void O({title:"\u062e\u0637\u0623",description:"\u0644\u0627 \u062a\u0648\u062c\u062f \u0628\u064a\u0627\u0646\u0627\u062a \u0635\u0627\u0644\u062d\u0629 \u0641\u064a \u0627\u0644\u0645\u0644\u0641",variant:"destructive"});const i=c.map(e=>e[l[o]]||e["Merchant ID"]||e.merchant_id),d=i.filter((e,t)=>i.indexOf(e)!==t);if(d.length>0){const e=[...new Set(d)];O({title:"\u062a\u062d\u0630\u064a\u0631",description:"\u062a\u0645 \u0627\u0644\u0639\u062b\u0648\u0631 \u0639\u0644\u0649 \u062a\u0643\u0631\u0627\u0631\u0627\u062a \u0641\u064a \u0627\u0644\u0645\u0644\u0641: ".concat(e.join(", "),". \u0633\u064a\u062a\u0645 \u062a\u062c\u0627\u0647\u0644 \u0627\u0644\u062a\u0643\u0631\u0627\u0631\u0627\u062a."),variant:"warning"})}const m=new Set,x=c.filter(e=>{const t=e[l[o]]||e["Merchant ID"]||e.merchant_id;return!(!t||m.has(t))&&(m.add(t),!0)});Y({total:c.length,unique:x.length,duplicates:c.length-x.length,merchants:x,headers:l})}catch(t){console.error("Error reading file:",t),O({title:"\u062e\u0637\u0623",description:"\u062d\u062f\u062b \u062e\u0637\u0623 \u0641\u064a \u0642\u0631\u0627\u0621\u0629 \u0627\u0644\u0645\u0644\u0641. \u062a\u0623\u0643\u062f \u0645\u0646 \u0623\u0646 \u0627\u0644\u0645\u0644\u0641 \u0635\u062d\u064a\u062d.",variant:"destructive"})}},"csv"===n?s.readAsText(t,"UTF-8"):s.readAsArrayBuffer(t)},className:"w-full py-3 px-4 rounded-xl cursor-pointer border-2 border-dashed",style:{borderColor:"var(--primary-600)",background:"var(--bg)"}})]}),(0,N.jsxs)("div",{className:"flex gap-3 justify-end mt-6",children:[(0,N.jsx)("button",{type:"button",onClick:()=>{V(!1),Y(null),Z.current&&(Z.current.value="")},disabled:Q,className:"ds-btn ds-btn-outline px-4 py-2.5 rounded-xl disabled:opacity-50",children:X?"\u0625\u0644\u063a\u0627\u0621":"\u0625\u063a\u0644\u0627\u0642"}),X&&(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)("button",{type:"button",onClick:()=>{Y(null),Z.current&&(Z.current.value="")},disabled:Q,className:"ds-btn ds-btn-outline px-4 py-2.5 rounded-xl disabled:opacity-50",children:"\u0631\u0641\u0639 \u0645\u0644\u0641 \u0622\u062e\u0631"}),(0,N.jsx)("button",{type:"button",onClick:async()=>{if(X&&0!==X.merchants.length){J(!0);try{const e=X.merchants.map(e=>({merchant_id:e[X.headers.find(e=>e&&e.toLowerCase().includes("merchant")&&e.toLowerCase().includes("id"))||"Merchant ID"]||e["Merchant ID"]||e.merchant_id,governorate:e["\u0627\u0644\u0645\u062d\u0627\u0641\u0638\u0629"]||e.governorate||"",ministry:e["\u0627\u0644\u0648\u0632\u0627\u0631\u0629"]||e.ministry||"",directorate_name:e["\u0627\u0633\u0645 \u0627\u0644\u0645\u062f\u064a\u0631\u064a\u0629"]||e.directorate_name||e["\u0627\u0644\u0645\u062f\u064a\u0631\u064a\u0629"]||"",details:e["\u0627\u0644\u062a\u0641\u0627\u0635\u064a\u0644"]||e.details||"",device_count:parseInt(e["\u0639\u062f\u062f \u0627\u0644\u0623\u062c\u0647\u0632\u0629"]||e.device_count||0),iban:e.IBAN||e.iban||"",account_key:e.key||e.account_key||"",account_number:e["\u0631\u0642\u0645 \u0627\u0644\u062d\u0640\u0640\u0640\u0640\u0633\u0627\u0628"]||e["\u0631\u0642\u0645 \u0627\u0644\u062d\u0633\u0627\u0628"]||e.account_number||"",branch_name:e["\u0627\u0633\u0645 \u0627\u0644\u0641\u0631\u0639"]||e.branch_name||"",branch_number:e["\u0631\u0642\u0645 \u0627\u0644\u0641\u0631\u0639"]||e.branch_number||"",bank_code:e["\u0627\u0644\u0645\u0635\u0631\u0641"]||e.bank_code||"",bank_name:e["\u0627\u0644\u0645\u0635\u0631\u06412"]||e.bank_name||"",bank_name_alt:e["\u0627\u0644\u0645\u0635\u0631\u06413"]||e.bank_name_alt||"",iban_length_check:parseInt(e["\u0627\u0644\u062a\u062d\u0642\u0642 \u0645\u0646 \u0637\u0648\u0644 \u0627\u0644\u0627\u064a\u0628\u0627\u0646"]||e.iban_length_check||23),notes:e["\u0627\u0644\u0645\u0644\u0627\u062d\u0638\u0627\u062a"]||e.notes||"",settlement_name:e["\u0627\u0633\u0645 \u0627\u0644\u062a\u0633\u0648\u064a\u0629"]||e.settlement_name||"",commission_type:e["\u0646\u0648\u0639 \u0627\u0644\u0639\u0645\u0648\u0644\u0629"]||e.commission_type||"\u062d\u0643\u0648\u0645\u064a"})),t=await a.A.post("/merchants/import",{merchants:e,rejectDuplicates:!0});if(t.data.errors&&t.data.errors.length>0){const e=t.data.errors.filter(e=>e.error&&e.error.includes("\u0645\u0648\u062c\u0648\u062f")||e.error&&e.error.includes("duplicate")),n=t.data.errors.filter(e=>!e.error||!e.error.includes("\u0645\u0648\u062c\u0648\u062f")&&!e.error.includes("duplicate"));e.length>0&&O({title:"\u062a\u062d\u0630\u064a\u0631",description:"\u062a\u0645 \u0631\u0641\u0636 ".concat(e.length," \u062a\u0627\u062c\u0631 \u0628\u0633\u0628\u0628 \u062a\u0643\u0631\u0627\u0631 Merchant ID"),variant:"warning"}),n.length>0&&O({title:"\u062a\u062d\u0630\u064a\u0631",description:"\u0641\u0634\u0644 \u0627\u0633\u062a\u064a\u0631\u0627\u062f ".concat(n.length," \u062a\u0627\u062c\u0631 \u0628\u0633\u0628\u0628 \u0623\u062e\u0637\u0627\u0621 \u0623\u062e\u0631\u0649"),variant:"warning"})}t.data.imported>0&&O({title:"\u0646\u062c\u062d",description:"\u062a\u0645 \u0627\u0633\u062a\u064a\u0631\u0627\u062f ".concat(t.data.imported," \u062a\u0627\u062c\u0631 \u0628\u0646\u062c\u0627\u062d"),variant:"success"}),V(!1),Y(null),Z.current&&(Z.current.value=""),te()}catch(n){var e,t;console.error("Import error:",n),O({title:"\u062e\u0637\u0623",description:(null===(e=n.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.error)||"\u062d\u062f\u062b \u062e\u0637\u0623 \u0641\u064a \u0627\u0644\u0627\u0633\u062a\u064a\u0631\u0627\u062f",variant:"destructive"})}finally{J(!1)}}else O({title:"\u062e\u0637\u0623",description:"\u0644\u0627 \u062a\u0648\u062c\u062f \u0628\u064a\u0627\u0646\u0627\u062a \u0644\u0644\u0627\u0633\u062a\u064a\u0631\u0627\u062f",variant:"destructive"})},disabled:Q,className:"ds-btn ds-btn-primary px-4 py-2.5 rounded-xl disabled:opacity-50",children:Q?"\u062c\u0627\u0631\u064a \u0627\u0644\u0627\u0633\u062a\u064a\u0631\u0627\u062f...":"\u0627\u0633\u062a\u064a\u0631\u0627\u062f ".concat(X.unique," \u062a\u0627\u062c\u0631")})]})]})]})]})})]})})}},94505(e,t,n){n.d(t,{A:()=>l});var s=n(79722);const r={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_WS_URL:"ws://localhost:5001"}.REACT_APP_API_URL||"http://localhost:5000/api",a=s.A.create({baseURL:r,headers:{"Content-Type":"application/json"}});a.interceptors.request.use(e=>{const t=localStorage.getItem("token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e.data instanceof FormData&&delete e.headers["Content-Type"],e},e=>Promise.reject(e)),a.interceptors.response.use(e=>e,e=>{var t,n,s;return 401!==(null===(t=e.response)||void 0===t?void 0:t.status)||null!==(n=e.config)&&void 0!==n&&null!==(s=n.url)&&void 0!==s&&s.includes("/auth/login")||(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login"),Promise.reject(e)});const l=a}}]);
//# sourceMappingURL=470.c226360a.chunk.js.map
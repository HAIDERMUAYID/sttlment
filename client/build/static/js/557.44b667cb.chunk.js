/*! For license information please see 557.44b667cb.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunksttlment_client=self.webpackChunksttlment_client||[]).push([[557],{25851(e,r,a){a.d(r,{T:()=>l});var s=a(2240),t=a(52422);function l(e,r){const a=(0,s.n)(e=>e.user);return!!a&&(0,t._m)(a.permissions,a.role,e,r)}},35087(e,r,a){a.d(r,{A:()=>s});const s=(0,a(21639).A)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},49954(e,r,a){a.d(r,{p:()=>u});var s=a(22555),t=a(53986),l=a(65043),o=a(15074),i=a(70579);const n=["className","type","style","error","errorId","onFocus","onBlur"],d="rgba(220, 38, 38, 0.6)",c="rgba(2, 97, 116, 0.25)",u=l.forwardRef((e,r)=>{let{className:a,type:l,style:u,error:v,errorId:x,onFocus:m,onBlur:p}=e,h=(0,t.A)(e,n);return(0,i.jsx)("input",(0,s.A)({type:l,className:(0,o.cn)("flex h-10 w-full rounded-xl border px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-[#026174]/40 disabled:cursor-not-allowed disabled:opacity-50 transition-all",a),style:(0,s.A)({borderColor:v?d:c,background:"#ffffff",color:"#0f172a"},u||{}),onFocus:e=>{e.target.style.borderColor=v?d:"#068294",e.target.style.boxShadow=v?"none":"0 0 0 2px rgba(2, 97, 116, 0.25)",null===m||void 0===m||m(e)},onBlur:e=>{e.target.style.borderColor=v?d:c,e.target.style.boxShadow="none",null===p||void 0===p||p(e)},ref:r,"aria-invalid":!!v||void 0,"aria-describedby":v&&x?x:void 0},h))});u.displayName="Input"},50797(e,r,a){a.d(r,{A:()=>s});const s=(0,a(21639).A)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]])},65727(e,r,a){a.d(r,{A:()=>s});const s=(0,a(21639).A)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]])},85557(e,r,a){a.d(r,{ChangePasswordV2:()=>j});var s=a(22555),t=a(65043),l=a(73375),o=a(69772),i=a(49954),n=a(51704),d=a(2240),c=a(6931),u=a(25851),v=a(19162),x=a(14459);const m=(0,a(21639).A)("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);var p=a(50797),h=a(40614),y=a(65727),f=a(94651),b=a(35087),w=a(6171),g=a(70579);function j(){const{toast:e}=(0,n.dj)(),{user:r,updateUser:a}=(0,d.n)(),j=(0,u.T)("change_password","self_update"),[N,A]=(0,t.useState)({currentPassword:"",newPassword:"",confirmPassword:""}),[k,P]=(0,t.useState)({current:!1,new:!1,confirm:!1}),[C,z]=(0,t.useState)(!1),[S,M]=(0,t.useState)(!1),F=(0,t.useRef)(null),{data:q,refetch:B}=(0,c.I)({queryKey:["current-user"],queryFn:async()=>(await v.A.get("/auth/verify")).data.user,enabled:!!r}),E=(null===q||void 0===q?void 0:q.avatarUrl)||(null===r||void 0===r?void 0:r.avatarUrl),G=E?"".concat(window.location.origin).concat(E):null;return(0,g.jsx)("div",{className:"min-h-screen p-6 md:p-8",dir:"rtl",style:{background:"linear-gradient(180deg, #f1f5f9 0%, #e2e8f0 100%)"},children:(0,g.jsxs)("div",{className:"max-w-2xl mx-auto space-y-6",children:[(0,g.jsx)(l.P.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"page-header-teal rounded-xl p-6 mb-6",style:{background:"linear-gradient(135deg, #026174 0%, #068294 100%)",color:"#fff",boxShadow:"0 10px 30px rgba(2, 97, 116, 0.35)"},children:(0,g.jsxs)("div",{className:"flex items-center gap-4",children:[(0,g.jsx)("div",{className:"w-14 h-14 rounded-2xl flex items-center justify-center",style:{background:"rgba(255,255,255,0.2)"},children:(0,g.jsx)(x.A,{className:"w-7 h-7 text-white"})}),(0,g.jsxs)("div",{children:[(0,g.jsx)("h1",{className:"text-2xl font-bold m-0 text-white",children:"\u0627\u0644\u0625\u0639\u062f\u0627\u062f\u0627\u062a \u0627\u0644\u0634\u062e\u0635\u064a\u0629"}),(0,g.jsx)("p",{className:"text-sm opacity-95 mt-1 m-0 text-white",children:"\u0625\u062f\u0627\u0631\u0629 \u0627\u0644\u0635\u0648\u0631\u0629 \u0627\u0644\u0634\u062e\u0635\u064a\u0629 \u0648\u0643\u0644\u0645\u0629 \u0627\u0644\u0645\u0631\u0648\u0631"})]})]})}),(0,g.jsxs)(l.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"rounded-2xl p-6 border-2",style:{background:"var(--surface)",borderColor:"var(--border-card)",boxShadow:"var(--shadow-card)"},children:[(0,g.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,g.jsx)("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center",style:{background:"rgba(2, 97, 116, 0.1)"},children:(0,g.jsx)(m,{className:"w-5 h-5",style:{color:"var(--primary-600)"}})}),(0,g.jsx)("h2",{className:"text-base font-bold m-0",style:{color:"var(--text-strong)"},children:"\u0627\u0644\u0635\u0648\u0631\u0629 \u0627\u0644\u0634\u062e\u0635\u064a\u0629"})]}),(0,g.jsxs)("div",{className:"flex items-center gap-6",children:[(0,g.jsx)(w.e,{src:G,alt:(null===r||void 0===r?void 0:r.name)||"",size:"xl"}),(0,g.jsxs)("div",{className:"flex-1 space-y-3",children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("input",{ref:F,type:"file",accept:"image/*",className:"hidden",onChange:async r=>{var s;const t=null===(s=r.target.files)||void 0===s?void 0:s[0];if(!t)return;if(!["image/jpeg","image/jpg","image/png","image/gif","image/webp"].includes(t.type))return e({title:"\u062e\u0637\u0623",description:"\u0646\u0648\u0639 \u0627\u0644\u0645\u0644\u0641 \u063a\u064a\u0631 \u0645\u062f\u0639\u0648\u0645. \u064a\u064f\u0633\u0645\u062d \u0641\u0642\u0637 \u0628\u0645\u0644\u0641\u0627\u062a \u0627\u0644\u0635\u0648\u0631 (JPEG, PNG, GIF, WEBP)",variant:"destructive"}),void(F.current&&(F.current.value=""));if(t.size>5242880)return e({title:"\u062e\u0637\u0623",description:"\u062d\u062c\u0645 \u0627\u0644\u0645\u0644\u0641 \u0643\u0628\u064a\u0631 \u062c\u062f\u0627\u064b. \u0627\u0644\u062d\u062f \u0627\u0644\u0623\u0642\u0635\u0649 \u0647\u0648 5MB",variant:"destructive"}),void(F.current&&(F.current.value=""));M(!0);const l=new FormData;l.append("avatar",t);try{const r=await v.A.post("/users/avatar",l,{headers:{"Content-Type":"multipart/form-data"}});a({avatarUrl:r.data.avatar_url}),B(),e({title:"\u0646\u062c\u062d",description:"\u062a\u0645 \u0631\u0641\u0639 \u0627\u0644\u0635\u0648\u0631\u0629 \u0627\u0644\u0634\u062e\u0635\u064a\u0629 \u0628\u0646\u062c\u0627\u062d"})}catch(n){var o,i;e({title:"\u062e\u0637\u0623",description:(null===(o=n.response)||void 0===o||null===(i=o.data)||void 0===i?void 0:i.error)||"\u062d\u062f\u062b \u062e\u0637\u0623 \u0641\u064a \u0631\u0641\u0639 \u0627\u0644\u0635\u0648\u0631\u0629",variant:"destructive"})}finally{M(!1),F.current&&(F.current.value="")}},disabled:S}),(0,g.jsxs)(o.$,{type:"button",variant:"outline",size:"sm",disabled:S,onClick:()=>{var e;return null===(e=F.current)||void 0===e?void 0:e.click()},className:"border-2 text-[var(--primary-600)] hover:bg-[#eef9fb] hover:border-[#026174]",style:{borderColor:"var(--primary-600)"},children:[(0,g.jsx)(p.A,{className:"h-4 w-4 ml-2"}),S?"\u062c\u0627\u0631\u064a \u0627\u0644\u0631\u0641\u0639...":"\u0631\u0641\u0639 \u0635\u0648\u0631\u0629 \u062c\u062f\u064a\u062f\u0629"]})]}),E&&(0,g.jsxs)(o.$,{type:"button",variant:"outline",size:"sm",onClick:async()=>{try{await v.A.delete("/users/avatar"),a({avatarUrl:null}),B(),e({title:"\u0646\u062c\u062d",description:"\u062a\u0645 \u062d\u0630\u0641 \u0627\u0644\u0635\u0648\u0631\u0629 \u0627\u0644\u0634\u062e\u0635\u064a\u0629 \u0628\u0646\u062c\u0627\u062d"})}catch(t){var r,s;e({title:"\u062e\u0637\u0623",description:(null===(r=t.response)||void 0===r||null===(s=r.data)||void 0===s?void 0:s.error)||"\u062d\u062f\u062b \u062e\u0637\u0623 \u0641\u064a \u062d\u0630\u0641 \u0627\u0644\u0635\u0648\u0631\u0629",variant:"destructive"})}},className:"text-red-600 border-red-300 hover:bg-red-50 hover:border-red-400",children:[(0,g.jsx)(h.A,{className:"h-4 w-4 ml-2"}),"\u062d\u0630\u0641 \u0627\u0644\u0635\u0648\u0631\u0629"]}),(0,g.jsx)("p",{className:"text-xs m-0",style:{color:"var(--text-muted)"},children:"\u064a\u064f\u0633\u0645\u062d \u0628\u0645\u0644\u0641\u0627\u062a \u0627\u0644\u0635\u0648\u0631 (JPEG, PNG, GIF, WEBP) \u0628\u062d\u062f \u0623\u0642\u0635\u0649 5MB"})]})]})]}),(0,g.jsxs)(l.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.05},className:"rounded-2xl p-6 border-2",style:{background:"var(--surface)",borderColor:"var(--border-card)",boxShadow:"var(--shadow-card)"},children:[(0,g.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,g.jsx)("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center",style:{background:"rgba(2, 97, 116, 0.1)"},children:(0,g.jsx)(y.A,{className:"w-5 h-5",style:{color:"var(--primary-600)"}})}),(0,g.jsx)("h2",{className:"text-base font-bold m-0",style:{color:"var(--text-strong)"},children:"\u0643\u0644\u0645\u0629 \u0627\u0644\u0645\u0631\u0648\u0631"})]}),j?(0,g.jsx)(g.Fragment,{children:(0,g.jsxs)("form",{onSubmit:async r=>{if(r.preventDefault(),N.currentPassword&&N.newPassword&&N.confirmPassword)if(N.newPassword===N.confirmPassword)if(N.newPassword.length<6)e({title:"\u062e\u0637\u0623",description:"\u0643\u0644\u0645\u0629 \u0627\u0644\u0645\u0631\u0648\u0631 \u064a\u062c\u0628 \u0623\u0646 \u062a\u0643\u0648\u0646 6 \u0623\u062d\u0631\u0641 \u0639\u0644\u0649 \u0627\u0644\u0623\u0642\u0644",variant:"destructive"});else{z(!0);try{await v.A.post("/auth/change-password",{currentPassword:N.currentPassword,newPassword:N.newPassword}),e({title:"\u0646\u062c\u062d",description:"\u062a\u0645 \u062a\u063a\u064a\u064a\u0631 \u0643\u0644\u0645\u0629 \u0627\u0644\u0645\u0631\u0648\u0631 \u0628\u0646\u062c\u0627\u062d"}),A({currentPassword:"",newPassword:"",confirmPassword:""})}catch(t){var a,s;e({title:"\u062e\u0637\u0623",description:(null===(a=t.response)||void 0===a||null===(s=a.data)||void 0===s?void 0:s.error)||"\u062d\u062f\u062b \u062e\u0637\u0623",variant:"destructive"})}finally{z(!1)}}else e({title:"\u062e\u0637\u0623",description:"\u0643\u0644\u0645\u0629 \u0627\u0644\u0645\u0631\u0648\u0631 \u0627\u0644\u062c\u062f\u064a\u062f\u0629 \u0648\u062a\u0623\u0643\u064a\u062f\u0647\u0627 \u063a\u064a\u0631 \u0645\u062a\u0637\u0627\u0628\u0642\u064a\u0646",variant:"destructive"});else e({title:"\u062e\u0637\u0623",description:"\u062c\u0645\u064a\u0639 \u0627\u0644\u062d\u0642\u0648\u0644 \u0645\u0637\u0644\u0648\u0628\u0629",variant:"destructive"})},className:"space-y-4",children:[(0,g.jsxs)("div",{className:"space-y-2",children:[(0,g.jsx)("label",{className:"text-sm font-semibold block",style:{color:"var(--text-strong)"},children:"\u0643\u0644\u0645\u0629 \u0627\u0644\u0645\u0631\u0648\u0631 \u0627\u0644\u062d\u0627\u0644\u064a\u0629 *"}),(0,g.jsxs)("div",{className:"relative",children:[(0,g.jsx)(i.p,{type:k.current?"text":"password",value:N.currentPassword,onChange:e=>A((0,s.A)((0,s.A)({},N),{},{currentPassword:e.target.value})),placeholder:"\u0623\u062f\u062e\u0644 \u0643\u0644\u0645\u0629 \u0627\u0644\u0645\u0631\u0648\u0631 \u0627\u0644\u062d\u0627\u0644\u064a\u0629",required:!0,className:"border-2 border-[#b8dce2] focus:border-[#026174] focus:ring-2 focus:ring-[#026174]/20 pr-10"}),(0,g.jsx)(o.$,{type:"button",variant:"ghost",size:"icon",className:"absolute left-2 top-1/2 -translate-y-1/2 text-[var(--text-muted)] hover:text-[var(--text-strong)]",onClick:()=>P((0,s.A)((0,s.A)({},k),{},{current:!k.current})),children:k.current?(0,g.jsx)(f.A,{className:"h-4 w-4"}):(0,g.jsx)(b.A,{className:"h-4 w-4"})})]})]}),(0,g.jsxs)("div",{className:"space-y-2",children:[(0,g.jsx)("label",{className:"text-sm font-semibold block",style:{color:"var(--text-strong)"},children:"\u0643\u0644\u0645\u0629 \u0627\u0644\u0645\u0631\u0648\u0631 \u0627\u0644\u062c\u062f\u064a\u062f\u0629 *"}),(0,g.jsxs)("div",{className:"relative",children:[(0,g.jsx)(i.p,{type:k.new?"text":"password",value:N.newPassword,onChange:e=>A((0,s.A)((0,s.A)({},N),{},{newPassword:e.target.value})),placeholder:"\u0623\u062f\u062e\u0644 \u0643\u0644\u0645\u0629 \u0627\u0644\u0645\u0631\u0648\u0631 \u0627\u0644\u062c\u062f\u064a\u062f\u0629",required:!0,className:"border-2 border-[#b8dce2] focus:border-[#026174] focus:ring-2 focus:ring-[#026174]/20 pr-10"}),(0,g.jsx)(o.$,{type:"button",variant:"ghost",size:"icon",className:"absolute left-2 top-1/2 -translate-y-1/2 text-[var(--text-muted)] hover:text-[var(--text-strong)]",onClick:()=>P((0,s.A)((0,s.A)({},k),{},{new:!k.new})),children:k.new?(0,g.jsx)(f.A,{className:"h-4 w-4"}):(0,g.jsx)(b.A,{className:"h-4 w-4"})})]}),(0,g.jsx)("p",{className:"text-xs m-0",style:{color:"var(--text-muted)"},children:"\u064a\u062c\u0628 \u0623\u0646 \u062a\u0643\u0648\u0646 6 \u0623\u062d\u0631\u0641 \u0639\u0644\u0649 \u0627\u0644\u0623\u0642\u0644"})]}),(0,g.jsxs)("div",{className:"space-y-2",children:[(0,g.jsx)("label",{className:"text-sm font-semibold block",style:{color:"var(--text-strong)"},children:"\u062a\u0623\u0643\u064a\u062f \u0643\u0644\u0645\u0629 \u0627\u0644\u0645\u0631\u0648\u0631 \u0627\u0644\u062c\u062f\u064a\u062f\u0629 *"}),(0,g.jsxs)("div",{className:"relative",children:[(0,g.jsx)(i.p,{type:k.confirm?"text":"password",value:N.confirmPassword,onChange:e=>A((0,s.A)((0,s.A)({},N),{},{confirmPassword:e.target.value})),placeholder:"\u0623\u0639\u062f \u0625\u062f\u062e\u0627\u0644 \u0643\u0644\u0645\u0629 \u0627\u0644\u0645\u0631\u0648\u0631 \u0627\u0644\u062c\u062f\u064a\u062f\u0629",required:!0,className:"border-2 border-[#b8dce2] focus:border-[#026174] focus:ring-2 focus:ring-[#026174]/20 pr-10"}),(0,g.jsx)(o.$,{type:"button",variant:"ghost",size:"icon",className:"absolute left-2 top-1/2 -translate-y-1/2 text-[var(--text-muted)] hover:text-[var(--text-strong)]",onClick:()=>P((0,s.A)((0,s.A)({},k),{},{confirm:!k.confirm})),children:k.confirm?(0,g.jsx)(f.A,{className:"h-4 w-4"}):(0,g.jsx)(b.A,{className:"h-4 w-4"})})]})]}),(0,g.jsx)(o.$,{type:"submit",className:"w-full text-white border-0",style:{background:"linear-gradient(135deg, #026174 0%, #068294 100%)",boxShadow:"0 4px 12px rgba(2, 97, 116, 0.35)"},disabled:C,children:C?"\u062c\u0627\u0631\u064a \u0627\u0644\u062a\u062d\u062f\u064a\u062b...":"\u062a\u063a\u064a\u064a\u0631 \u0643\u0644\u0645\u0629 \u0627\u0644\u0645\u0631\u0648\u0631"})]})}):(0,g.jsx)("p",{className:"text-sm m-0",style:{color:"var(--muted-foreground)"},children:"\u0644\u0627 \u062a\u0648\u062c\u062f \u0644\u062f\u064a\u0643 \u0635\u0644\u0627\u062d\u064a\u0629 \u0644\u062a\u063a\u064a\u064a\u0631 \u0643\u0644\u0645\u0629 \u0627\u0644\u0645\u0631\u0648\u0631. \u062a\u0648\u0627\u0635\u0644 \u0645\u0639 \u0627\u0644\u0645\u062f\u064a\u0631 \u0625\u0646 \u0627\u062d\u062a\u062c\u062a \u062a\u0641\u0639\u064a\u0644\u0647\u0627."})]})]})})}},94651(e,r,a){a.d(r,{A:()=>s});const s=(0,a(21639).A)("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]])}}]);
//# sourceMappingURL=557.44b667cb.chunk.js.map
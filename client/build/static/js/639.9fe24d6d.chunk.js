/*! For license information please see 639.9fe24d6d.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunksttlment_client=self.webpackChunksttlment_client||[]).push([[639],{8567(e,t,a){a.d(t,{E:()=>c});var s=a(22555),l=a(53986),n=(a(65043),a(10917)),r=a(15074),i=a(70579);const d=["className","variant"],o=(0,n.F)("inline-flex items-center rounded-lg border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-[#026174] text-white hover:bg-[#01505f]",secondary:"border-transparent bg-[#068294] text-white hover:bg-[#057a8a]",destructive:"border-transparent bg-[#ef4444] text-white hover:bg-[#dc2626]",outline:"border-[rgba(2,97,116,0.3)] bg-transparent text-[#026174]",success:"border-transparent bg-[#22c55e] text-white hover:bg-[#16a34a]",warning:"border-transparent bg-[#f59e0b] text-white hover:bg-[#d97706]",info:"border-transparent bg-[#026174] text-white hover:bg-[#01505f]"}},defaultVariants:{variant:"default"}});function c(e){let{className:t,variant:a}=e,n=(0,l.A)(e,d);return(0,i.jsx)("div",(0,s.A)({className:(0,r.cn)(o({variant:a}),t)},n))}},35087(e,t,a){a.d(t,{A:()=>s});const s=(0,a(21639).A)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},47810(e,t,a){a.d(t,{T:()=>o});var s=a(22555),l=a(53986),n=a(65043),r=a(15074),i=a(70579);const d=["className"],o=n.forwardRef((e,t)=>{let{className:a}=e,n=(0,l.A)(e,d);return(0,i.jsx)("textarea",(0,s.A)({className:(0,r.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 transition-all resize-none",a),ref:t},n))});o.displayName="Textarea"},50516(e,t,a){a.d(t,{A:()=>s});const s=(0,a(21639).A)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},61639(e,t,a){a.d(t,{TasksV2:()=>Z});var s=a(22555),l=a(65043),n=a(6931),r=a(73375),i=a(96938),d=a(69772),o=a(49954),c=a(8567),m=a(72147),u=a(70492),x=a(47810),p=a(63248),h=a(47097),g=a(19162),b=a(51704);const v=(0,a(4548).vt)(e=>({dailyTasks:[],adHocTasks:[],setDailyTasks:t=>e({dailyTasks:t}),setAdHocTasks:t=>e({adHocTasks:t}),addTask:t=>e(e=>"daily"===t.type?{dailyTasks:[...e.dailyTasks,t]}:{adHocTasks:[...e.adHocTasks,t]}),updateTask:(t,a)=>e(e=>({dailyTasks:e.dailyTasks.map(e=>e.id===t?(0,s.A)((0,s.A)({},e),a):e),adHocTasks:e.adHocTasks.map(e=>e.id===t?(0,s.A)((0,s.A)({},e),a):e)})),removeTask:(t,a)=>e(e=>"daily"===a?{dailyTasks:e.dailyTasks.filter(e=>e.id!==t)}:{adHocTasks:e.adHocTasks.filter(e=>e.id!==t)})}));var y=a(2240),f=a(25851),j=a(60271),N=a(41680),w=a(35087),k=a(21888),_=a(95919),A=a(66709),T=a(50516),S=a(71360),C=a(75088),E=a(35613),M=a(38298),L=a(39292),P=a(28646),I=a(34348),F=a.n(I),H=a(95773),Y=a(50490),q=a(70579);function D(e){let{show:t,onComplete:a,duration:s=2400,subtitle:n="\u062a\u0633\u0648\u064a\u0629 \u0645\u0637\u0627\u0628\u0642\u0629"}=e;const[d,o]=(0,l.useState)(t),[c,m]=(0,l.useState)(0);return(0,l.useEffect)(()=>{if(o(t),m(0),!t)return;const e=Date.now(),l=setInterval(()=>{const t=Date.now()-e;m(Math.min(t/s*100,100))},50),n=setTimeout(()=>{clearInterval(l),o(!1),null===a||void 0===a||a()},s);return()=>{clearTimeout(n),clearInterval(l)}},[t,s,a]),(0,q.jsx)(i.N,{children:d&&(0,q.jsxs)(r.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"fixed inset-0 z-[100] flex items-center justify-center backdrop-blur-md",style:{background:"rgba(42, 110, 133, 0.35)"},"aria-hidden":"true",children:[(0,q.jsx)(r.P.div,{initial:{scale:.8,opacity:0},animate:{scale:1.2,opacity:.15},exit:{scale:1,opacity:0},transition:{duration:.5},className:"absolute w-72 h-72 rounded-full border-4 border-emerald-400"}),(0,q.jsx)(r.P.div,{initial:{scale:.8,opacity:0},animate:{scale:1.1,opacity:.1},exit:{scale:1,opacity:0},transition:{duration:.5,delay:.1},className:"absolute w-64 h-64 rounded-full border-4 border-[#068294]"}),(0,q.jsxs)(r.P.div,{initial:{scale:.5,opacity:0,rotate:-12},animate:{scale:1,opacity:1,rotate:0},exit:{scale:.9,opacity:0},transition:{type:"spring",stiffness:280,damping:22},className:"relative flex flex-col items-center justify-center",children:[(0,q.jsxs)(r.P.div,{initial:{scale:.8},animate:{scale:1},transition:{type:"spring",stiffness:300,damping:18,delay:.1},className:"relative",children:[(0,q.jsx)("img",{src:"/stamp-settlement-reconciliation.png",alt:"\u062e\u062a\u0645 \u0627\u0644\u062a\u0633\u0648\u064a\u0629",className:"w-44 h-44 sm:w-52 sm:h-52 object-contain",style:{filter:"drop-shadow(0 10px 32px rgba(0,0,0,0.35)) drop-shadow(0 0 0 1px rgba(255,255,255,0.1))"}}),(0,q.jsx)(r.P.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.25,type:"spring",stiffness:400,damping:15},className:"absolute -bottom-1 -right-1 w-10 h-10 rounded-full bg-emerald-500 flex items-center justify-center shadow-lg","aria-hidden":!0,children:(0,q.jsx)("svg",{className:"w-6 h-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2.5,children:(0,q.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})})})]}),(0,q.jsx)(r.P.p,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.35},className:"mt-4 text-xl font-bold text-white drop-shadow-lg",children:n}),(0,q.jsx)(r.P.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.45},className:"mt-1 text-sm text-white/80",children:"\u062a\u0645 \u062d\u0641\u0638 \u0627\u0644\u062a\u0646\u0641\u064a\u0630 \u0628\u0646\u062c\u0627\u062d"}),(0,q.jsx)("div",{className:"mt-6 w-48 h-1 rounded-full bg-white/20 overflow-hidden",children:(0,q.jsx)(r.P.div,{className:"h-full rounded-full bg-emerald-400",initial:{width:0},animate:{width:"".concat(c,"%")},transition:{duration:.05}})})]})]})})}const O="#068294";function z(e){let{label:t,value:a,multiline:s}=e;return(0,q.jsxs)("div",{className:"flex justify-between items-start gap-4 p-3 rounded-xl border bg-white",style:{borderColor:"rgba(6, 130, 148, 0.2)",background:"rgba(255,255,255,0.95)"},children:[(0,q.jsxs)("span",{className:"font-medium shrink-0",style:{color:"#068294"},children:[t,":"]}),(0,q.jsx)("span",{className:s?"text-end whitespace-pre-wrap break-words flex-1":"font-semibold",style:{color:O},children:a})]})}function K(e){let{message:t}=e;return(0,q.jsxs)("div",{className:"rounded-2xl p-16 text-center",style:{background:"var(--surface)",boxShadow:"var(--shadow-card)",border:"1px solid var(--border)"},children:[(0,q.jsx)("div",{className:"w-16 h-16 rounded-2xl mx-auto mb-4 flex items-center justify-center",style:{background:"rgba(8, 131, 149, 0.08)"},children:(0,q.jsx)(N.A,{className:"w-8 h-8",style:{color:"var(--primary-600)"}})}),(0,q.jsx)("p",{className:"text-lg font-bold m-0",style:{color:"var(--text-strong)"},children:t})]})}function V(e){let{task:t,index:a,type:s,getStatusBadge:l,onDetails:n,onExecute:i,canExecute:d}=e;const o={completed:{bg:"rgba(22, 163, 74, 0.12)",bar:"linear-gradient(180deg, #16a34a, #22c55e)"},pending:{bg:"rgba(245, 158, 11, 0.12)",bar:"linear-gradient(180deg, #d97706, #f59e0b)"},overdue:{bg:"rgba(220, 38, 38, 0.12)",bar:"linear-gradient(180deg, #b91c1c, #dc2626)"}}[t.status]||{bg:"rgba(100, 116, 139, 0.12)",bar:"linear-gradient(180deg, var(--primary-800), var(--primary-600))"},c=t.template_title||t.title||"";return(0,q.jsxs)(r.P.div,{initial:{opacity:0,y:16},animate:{opacity:1,y:0},exit:{opacity:0,scale:.98},whileHover:{scale:1.15,y:-8,zIndex:20,boxShadow:"0 28px 56px rgba(2, 97, 116, 0.2), 0 0 0 1px rgba(8, 131, 149, 0.3)",transition:{duration:.3,ease:[.25,.46,.45,.94]}},transition:{duration:.25,delay:.03*a,ease:[.25,.46,.45,.94]},className:"group relative flex flex-col rounded-2xl overflow-hidden cursor-pointer",style:{background:"var(--surface)",border:"2px solid var(--border-card)",boxShadow:"0 2px 8px rgba(15, 23, 42, 0.06), inset 0 1px 0 rgba(255,255,255,0.8)"},children:[(0,q.jsx)("div",{className:"absolute inset-0 opacity-0 group-hover:opacity-100 pointer-events-none overflow-hidden rounded-2xl card-shine-hover"}),(0,q.jsx)("div",{className:"absolute top-0 bottom-0 w-1 rounded-r-full opacity-80 group-hover:opacity-100 group-hover:w-1.5 transition-all duration-300",style:{right:0,background:o.bar,boxShadow:"0 0 12px rgba(8, 131, 149, 0.3)"}}),(0,q.jsx)("div",{className:"absolute top-0 right-0 left-0 h-1 opacity-0 group-hover:opacity-100 transition-opacity duration-300",style:{background:"linear-gradient(90deg, var(--primary-600), var(--primary-800))"}}),(0,q.jsxs)("div",{className:"p-5 pl-5 pr-6 flex flex-col flex-1",children:[(0,q.jsxs)("div",{className:"flex items-start justify-between gap-3 mb-2",children:[(0,q.jsx)("h3",{className:"text-lg font-bold leading-snug line-clamp-2 flex-1 min-w-0",style:{color:"var(--text-strong)"},children:c}),l(t.status)]}),(0,q.jsxs)("div",{className:"flex flex-wrap gap-2 mb-3",children:[t.category_name&&(0,q.jsxs)("span",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 rounded-lg text-sm font-medium",style:{background:"rgba(8, 131, 149, 0.08)",color:"var(--primary-800)"},children:[(0,q.jsx)(N.A,{className:"w-3.5 h-3.5"}),t.category_name]}),t.target_settlement_date&&(0,q.jsxs)("span",{className:"px-2.5 py-1 rounded-lg text-xs font-mono bg-slate-100 text-slate-600",dir:"ltr",children:["\u062a\u0633\u0648\u064a\u0629 ",String(t.target_settlement_date).slice(0,10)]}),(0,q.jsx)("span",{className:"px-2 py-0.5 rounded text-xs font-medium",style:{background:o.bg,color:"daily"===s?"var(--primary-800)":"#7c3aed"},children:"daily"===s?"\u064a\u0648\u0645\u064a\u0629":"\u062e\u0627\u0635\u0629"})]}),(0,q.jsxs)("div",{className:"space-y-2 text-sm flex-1 mb-4",children:[t.assigned_to_name&&(0,q.jsxs)("div",{className:"flex justify-between items-center p-2 rounded-lg",style:{background:"rgba(6, 130, 148, 0.06)"},children:[(0,q.jsx)("span",{className:"font-medium",style:{color:"var(--text-muted)"},children:"\u0627\u0644\u0645\u0633\u0624\u0648\u0644:"}),(0,q.jsx)("span",{className:"font-semibold",style:{color:"var(--primary-800)"},children:t.assigned_to_name})]}),t.created_by_name&&"ad-hoc"===s&&(0,q.jsxs)("div",{className:"flex justify-between items-center p-2 rounded-lg",style:{background:"rgba(6, 130, 148, 0.06)"},children:[(0,q.jsx)("span",{className:"font-medium",style:{color:"var(--text-muted)"},children:"\u0623\u0646\u0634\u0623\u0647\u0627:"}),(0,q.jsx)("span",{className:"font-semibold",style:{color:"var(--primary-800)"},children:t.created_by_name})]}),t.task_date&&(0,q.jsxs)("div",{className:"flex justify-between items-center p-2 rounded-lg",style:{background:"rgba(6, 130, 148, 0.06)"},children:[(0,q.jsx)("span",{className:"font-medium",style:{color:"var(--text-muted)"},children:"\u0627\u0644\u062a\u0627\u0631\u064a\u062e:"}),(0,q.jsx)("span",{className:"font-semibold",dir:"ltr",children:F()(t.task_date).format("YYYY-MM-DD")})]})]}),(0,q.jsxs)("div",{className:"flex gap-2 pt-4 mt-auto border-t",style:{borderColor:"var(--border)"},children:[(0,q.jsxs)(r.P.button,{type:"button",onClick:e=>{e.stopPropagation(),n()},className:"ds-btn ds-btn-outline flex-1 flex items-center justify-center gap-2 text-sm",whileHover:{scale:1.03},whileTap:{scale:.98},children:[(0,q.jsx)(w.A,{className:"w-4 h-4"}),"\u062a\u0641\u0627\u0635\u064a\u0644"]}),"completed"!==t.status&&d&&(0,q.jsxs)(r.P.button,{type:"button",onClick:e=>{e.stopPropagation(),i()},className:"ds-btn ds-btn-primary flex-1 flex items-center justify-center gap-2 text-sm",whileHover:{scale:1.03},whileTap:{scale:.98},children:[(0,q.jsx)(k.A,{className:"w-4 h-4"}),"\u062a\u0646\u0641\u064a\u0630"]})]})]})]})}function Z(){var e;const{user:t}=(0,y.n)(),{toast:a}=(0,b.dj)(),[r,I]=(0,l.useState)(""),[Z,B]=(0,l.useState)(""),[Q,R]=(0,l.useState)("single"),[U,$]=(0,l.useState)(F()().tz("Asia/Baghdad").format("YYYY-MM-DD")),[G,W]=(0,l.useState)(""),[J,X]=(0,l.useState)(""),[ee,te]=(0,l.useState)(""),[ae,se]=(0,l.useState)("cards"),[le,ne]=(0,l.useState)("all"),[re,ie]=(0,l.useState)(!1),[de,oe]=(0,l.useState)(!1),[ce,me]=(0,l.useState)(!1),[ue,xe]=(0,l.useState)(null),[pe,he]=(0,l.useState)(null),[ge,be]=(0,l.useState)({resultStatus:"completed",notes:"",durationMinutes:"",settlement_date:"",settlement_value:""}),[ve,ye]=(0,l.useState)(""),[fe,je]=(0,l.useState)(!1),Ne=(0,f.T)("tasks","filter_by_assignee"),we=(0,f.T)("tasks","execute"),ke=(0,f.T)("tasks","create_ad_hoc"),_e=(0,f.T)("schedules","create"),Ae=(0,s.A)((0,s.A)((0,s.A)((0,s.A)({},"single"===Q&&U?{date:U}:{}),"range"===Q&&G&&J?{dateFrom:G,dateTo:J}:{}),Z?{view:Z}:{}),Ne&&ee?{assignedTo:ee}:{}),Te=(0,s.A)((0,s.A)((0,s.A)({},"range"===Q&&G&&J?{dateFrom:G,dateTo:J}:{}),Z?{view:Z}:{}),Ne&&ee?{assignedTo:ee}:{}),{data:Se=[],isLoading:Ce}=function(e){(0,p.jE)();const{setDailyTasks:t}=v();return(0,n.I)({queryKey:["daily-tasks",e],queryFn:async()=>{const a=new URLSearchParams;null!==e&&void 0!==e&&e.date&&a.append("date",e.date),null!==e&&void 0!==e&&e.dateFrom&&a.append("dateFrom",e.dateFrom),null!==e&&void 0!==e&&e.dateTo&&a.append("dateTo",e.dateTo),null!==e&&void 0!==e&&e.view&&a.append("view",e.view),null!==e&&void 0!==e&&e.assignedTo&&a.append("assignedTo",e.assignedTo);const l=(await g.A.get("/tasks/daily?".concat(a.toString()))).data.map(e=>(0,s.A)((0,s.A)({},e),{},{type:"daily"}));return t(l),l}})}(Ae),{data:Ee=[],isLoading:Me}=function(e){(0,p.jE)();const{setAdHocTasks:t}=v();return(0,n.I)({queryKey:["ad-hoc-tasks",e],queryFn:async()=>{const a=new URLSearchParams;null!==e&&void 0!==e&&e.dateFrom&&a.append("dateFrom",e.dateFrom),null!==e&&void 0!==e&&e.dateTo&&a.append("dateTo",e.dateTo),null!==e&&void 0!==e&&e.view&&a.append("view",e.view),null!==e&&void 0!==e&&e.assignedTo&&a.append("assignedTo",e.assignedTo);const l=(await g.A.get("/tasks/ad-hoc?".concat(a.toString()))).data.map(e=>(0,s.A)((0,s.A)({},e),{},{type:"ad-hoc"}));return t(l),l}})}(Te),Le=function(){const e=(0,p.jE)(),{toast:t}=(0,b.dj)();return(0,h.n)({mutationFn:async e=>(await g.A.post("/tasks/execute",e)).data,onSuccess:a=>{e.invalidateQueries({queryKey:["daily-tasks"]}),e.invalidateQueries({queryKey:["ad-hoc-tasks"]}),"matched"===(null===a||void 0===a?void 0:a.verification_status)?t({title:"\u062a\u0633\u0648\u064a\u0629 \u0645\u0637\u0627\u0628\u0642\u0629",description:"\u062a\u0645 \u0627\u0644\u062a\u062d\u0642\u0642 \u0645\u0646 \u0642\u064a\u0645\u0629 \u0627\u0644\u062a\u0633\u0648\u064a\u0629 \u0645\u0639 \u0635\u0641\u062d\u0629 \u0627\u0644\u062a\u0633\u0648\u064a\u0627\u062a \u0627\u0644\u062d\u0643\u0648\u0645\u064a\u0629 \u0628\u0646\u062c\u0627\u062d.",variant:"success"}):t({title:"\u0646\u062c\u062d",description:"\u062a\u0645 \u062a\u0633\u062c\u064a\u0644 \u062a\u0646\u0641\u064a\u0630 \u0627\u0644\u0645\u0647\u0645\u0629 \u0628\u0646\u062c\u0627\u062d",variant:"success"})},onError:e=>{var a,s,l,n;"SETTLEMENT_MISMATCH"!==(null===(a=e.response)||void 0===a||null===(s=a.data)||void 0===s?void 0:s.code)&&t({title:"\u062e\u0637\u0623",description:(null===(l=e.response)||void 0===l||null===(n=l.data)||void 0===n?void 0:n.error)||e.message||"\u062d\u062f\u062b \u062e\u0637\u0623",variant:"destructive"})}})}(),Pe=function(){const e=(0,p.jE)(),{toast:t}=(0,b.dj)();return(0,h.n)({mutationFn:async e=>(await g.A.post("/tasks/ad-hoc",e)).data,onSuccess:()=>{e.invalidateQueries({queryKey:["ad-hoc-tasks"]}),t({title:"\u0646\u062c\u062d",description:"\u062a\u0645 \u0625\u0646\u0634\u0627\u0621 \u0627\u0644\u0645\u0647\u0645\u0629 \u0627\u0644\u062e\u0627\u0635\u0629 \u0628\u0646\u062c\u0627\u062d",variant:"success"})},onError:e=>{var a,s;t({title:"\u062e\u0637\u0623",description:(null===(a=e.response)||void 0===a||null===(s=a.data)||void 0===s?void 0:s.error)||"\u062d\u062f\u062b \u062e\u0637\u0623",variant:"destructive"})}})}(),Ie=function(){const e=(0,p.jE)(),{toast:t}=(0,b.dj)();return(0,h.n)({mutationFn:async()=>(await g.A.post("/tasks/generate-daily")).data,onSuccess:a=>{e.invalidateQueries({queryKey:["daily-tasks"]}),t({title:"\u0646\u062c\u062d",description:a.message||"\u062a\u0645 \u062a\u0648\u0644\u064a\u062f \u0627\u0644\u0645\u0647\u0627\u0645 \u0628\u0646\u062c\u0627\u062d",variant:"success"})},onError:e=>{var a,s;t({title:"\u062e\u0637\u0623",description:(null===(a=e.response)||void 0===a||null===(s=a.data)||void 0===s?void 0:s.error)||"\u062d\u062f\u062b \u062e\u0637\u0623",variant:"destructive"})}})}(),{data:Fe=[]}=(0,n.I)({queryKey:["users"],queryFn:async()=>(await g.A.get("/users")).data}),{data:He=[]}=(0,n.I)({queryKey:["templates"],queryFn:async()=>(await g.A.get("/templates?active=true")).data}),Ye=Ce||Me,qe=e=>[...e].sort((e,t)=>{const a="completed"!==e.status,s="completed"!==t.status;return a&&!s?-1:!a&&s?1:0}),De=e=>{if(!r.trim())return e;const t=r.toLowerCase().trim();return e.filter(e=>{const a=(e.template_title||e.title||"").toLowerCase(),s=(e.category_name||"").toLowerCase(),l=(e.assigned_to_name||"").toLowerCase(),n=(e.created_by_name||"").toLowerCase();return a.includes(t)||s.includes(t)||l.includes(t)||n.includes(t)})},Oe=(0,l.useMemo)(()=>De(qe(Se)),[Se,r]),ze=(0,l.useMemo)(()=>De(qe(Ee)),[Ee,r]),Ke="all"===le||"daily_only"===le,Ve="all"===le||"ad_hoc_only"===le,Ze={total:Se.length+Ee.length,pending:[...Se,...Ee].filter(e=>"pending"===e.status||"overdue"===e.status).length,completed:[...Se,...Ee].filter(e=>"completed"===e.status).length,overdue:Se.filter(e=>"overdue"===e.status).length},Be="daily"===(null===pe||void 0===pe?void 0:pe.type)&&"government_settlement_bank"===(null===pe||void 0===pe||null===(e=pe.template_required_fields)||void 0===e?void 0:e.category_type),Qe=e=>{var t;he((0,s.A)((0,s.A)({},e),{},{type:e.type||"daily"})),ye(""),"government_settlement_bank"===(null===(t=e.template_required_fields)||void 0===t?void 0:t.category_type)&&be(t=>(0,s.A)((0,s.A)({},t),{},{settlement_date:e.target_settlement_date?String(e.target_settlement_date).slice(0,10):"",settlement_value:""})),ie(!0)},Re=e=>{const t={completed:{variant:"success",label:"\u0645\u0643\u062a\u0645\u0644\u0629"},pending:{variant:"warning",label:"\u0645\u0639\u0644\u0642\u0629"},overdue:{variant:"destructive",label:"\u0645\u062a\u0623\u062e\u0631\u0629"},cancelled:{variant:"outline",label:"\u0645\u0644\u063a\u0627\u0629"},skipped:{variant:"outline",label:"\u062a\u062e\u0637\u064a"}}[e]||{variant:"default",label:e};return(0,q.jsx)(c.E,{variant:t.variant,children:t.label})};return(0,q.jsx)("div",{className:"min-h-screen",style:{padding:"1.5rem 2rem",background:"linear-gradient(180deg, #f1f5f9 0%, #e2e8f0 100%)"},children:(0,q.jsxs)("div",{className:"mx-auto",style:{maxWidth:"1400px"},children:[(0,q.jsx)(D,{show:fe,onComplete:()=>{je(!1),ie(!1),he(null),be({resultStatus:"completed",notes:"",durationMinutes:"",settlement_date:"",settlement_value:""})}}),(0,q.jsxs)("div",{className:"page-header-teal rounded-xl flex flex-wrap items-center justify-between gap-4 p-5 mb-6",style:{background:"linear-gradient(135deg, #026174 0%, #068294 100%)",color:"#ffffff",boxShadow:"0 10px 30px rgba(2, 97, 116, 0.35)"},children:[(0,q.jsxs)("div",{children:[(0,q.jsx)("h1",{className:"text-2xl font-bold m-0 text-white",children:"\u0627\u0644\u0645\u0647\u0627\u0645"}),(0,q.jsx)("p",{className:"text-sm opacity-90 mt-1 m-0 text-white",children:"\u0625\u062f\u0627\u0631\u0629 \u0648\u062a\u0646\u0641\u064a\u0630 \u0627\u0644\u0645\u0647\u0627\u0645 \u0627\u0644\u064a\u0648\u0645\u064a\u0629 \u0648\u0627\u0644\u062e\u0627\u0635\u0629"})]}),(0,q.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,q.jsxs)("div",{className:"flex rounded-full overflow-hidden border border-white/30 bg-white/10 p-0.5",children:[(0,q.jsxs)("button",{type:"button",onClick:()=>se("cards"),className:"flex items-center gap-2 px-3 py-2 rounded-full text-sm font-medium transition-colors ".concat("cards"===ae?"bg-white text-[#026174] shadow":"text-white/90 hover:bg-white/10"),children:[(0,q.jsx)(_.A,{className:"w-4 h-4"})," \u0643\u0631\u0648\u062a"]}),(0,q.jsxs)("button",{type:"button",onClick:()=>se("table"),className:"flex items-center gap-2 px-3 py-2 rounded-full text-sm font-medium transition-colors ".concat("table"===ae?"bg-white text-[#026174] shadow":"text-white/90 hover:bg-white/10"),children:[(0,q.jsx)(A.A,{className:"w-4 h-4"})," \u062c\u062f\u0648\u0644"]})]}),_e&&(0,q.jsxs)("button",{type:"button",onClick:()=>Ie.mutate(),disabled:Ie.isPending,className:"flex items-center gap-2 px-4 py-2 rounded-full text-sm font-medium bg-white/20 hover:bg-white/30 transition-colors text-white disabled:opacity-50",children:[(0,q.jsx)(T.A,{className:"w-4 h-4 ".concat(Ie.isPending?"animate-spin":"")})," \u062a\u0648\u0644\u064a\u062f \u0627\u0644\u0645\u0647\u0627\u0645"]}),ke&&(0,q.jsxs)("button",{type:"button",onClick:()=>oe(!0),className:"flex items-center gap-2 px-4 py-2 rounded-full text-sm font-medium bg-white text-[#026174] cursor-pointer hover:bg-white/95 transition-colors shadow",children:[(0,q.jsx)(S.A,{className:"w-4 h-4"})," \u0625\u0646\u0634\u0627\u0621 \u0645\u0646 \u0642\u0627\u0644\u0628"]})]})]}),(0,q.jsx)(Y.Q,{items:[{label:"\u0625\u062c\u0645\u0627\u0644\u064a \u0627\u0644\u0645\u0647\u0627\u0645",value:Ze.total,Icon:k.A,color:"#068294",glow:"rgba(6, 130, 148, 0.4)",gradient:"linear-gradient(135deg, #068294 0%, #026174 100%)"},{label:"\u0645\u0639\u0644\u0642\u0629",value:Ze.pending,Icon:C.A,color:"#f59e0b",glow:"rgba(245, 158, 11, 0.4)",gradient:"linear-gradient(135deg, #f59e0b 0%, #d97706 100%)"},{label:"\u0645\u0643\u062a\u0645\u0644\u0629",value:Ze.completed,Icon:k.A,color:"#059669",glow:"rgba(5, 150, 105, 0.4)",gradient:"linear-gradient(135deg, #059669 0%, #047857 100%)"},{label:"\u0645\u062a\u0623\u062e\u0631\u0629",value:Ze.overdue,Icon:E.A,color:"#dc2626",glow:"rgba(220, 38, 38, 0.4)",gradient:"linear-gradient(135deg, #dc2626 0%, #b91c1c 100%)"}]}),(0,q.jsxs)("div",{className:"rounded-2xl p-5 mb-6 border border-slate-200/80",style:{background:"linear-gradient(180deg, #ffffff 0%, #f8fafc 100%)",boxShadow:"0 4px 20px rgba(0,0,0,0.06)"},children:[(0,q.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,q.jsx)("div",{className:"p-1.5 rounded-lg bg-slate-100",children:(0,q.jsx)(M.A,{className:"w-4 h-4 text-slate-600"})}),(0,q.jsx)("span",{className:"text-base font-semibold text-slate-700",children:"\u0627\u0644\u0641\u0644\u0627\u062a\u0631 \u0648\u0627\u0644\u0628\u062d\u062b"})]}),(0,q.jsxs)("div",{className:"mb-4",children:[(0,q.jsx)("label",{className:"block text-xs font-medium text-slate-500 mb-1",children:"\u0628\u062d\u062b \u0641\u064a \u0627\u0644\u0645\u0647\u0627\u0645"}),(0,q.jsxs)("div",{className:"relative",children:[(0,q.jsx)(L.A,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),(0,q.jsx)("input",{type:"text",placeholder:"\u0627\u0628\u062d\u062b \u0639\u0646 \u0623\u064a \u0645\u0647\u0645\u0629 (\u0639\u0646\u0648\u0627\u0646\u060c \u0641\u0626\u0629\u060c \u0645\u0633\u0624\u0648\u0644...)",value:r,onChange:e=>I(e.target.value),className:"w-full pr-10 px-3 py-2 border border-slate-200 rounded-lg text-sm focus:ring-2 focus:ring-[#068294]/30 focus:border-[#068294] bg-white text-slate-800"})]}),(0,q.jsx)("p",{className:"text-xs mt-1.5 text-slate-500",children:"\u064a\u0645\u0643\u0646\u0643 \u0627\u0644\u0628\u062d\u062b \u0639\u0646 \u0623\u064a \u0645\u0647\u0645\u0629 \u0648\u0625\u0646\u062c\u0627\u0632\u0647\u0627 \u062d\u062a\u0649 \u0644\u0648 \u0644\u0645 \u062a\u0643\u0646 \u0645\u062e\u0635\u0635\u0629 \u0644\u0643"})]}),(0,q.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-5",children:[(0,q.jsxs)("div",{children:[(0,q.jsx)("label",{className:"block text-xs font-medium text-slate-500 mb-1",children:"\u0646\u0648\u0639 \u0627\u0644\u0645\u0647\u0627\u0645"}),(0,q.jsx)(m.Z,{value:le,onChange:e=>ne(e),options:[{value:"all",label:"\u0627\u0644\u0643\u0644 (\u0627\u0644\u064a\u0648\u0645\u064a\u0629 + \u0627\u0644\u062e\u0627\u0635\u0629)"},{value:"daily_only",label:"\u0627\u0644\u064a\u0648\u0645\u064a\u0629 \u0641\u0642\u0637"},{value:"ad_hoc_only",label:"\u0627\u0644\u062e\u0627\u0635\u0629 \u0641\u0642\u0637"}],getOptionLabel:e=>e.label,getOptionValue:e=>e.value,placeholder:"\u0627\u0644\u0643\u0644",searchPlaceholder:"\u0627\u0628\u062d\u062b..."})]}),(0,q.jsxs)("div",{children:[(0,q.jsx)("label",{className:"block text-xs font-medium text-slate-500 mb-1",children:"\u0639\u0631\u0636 \u0627\u0644\u0645\u0647\u0627\u0645"}),(0,q.jsx)(m.Z,{value:Z,onChange:B,options:[{value:"",label:"\u0627\u0644\u0643\u0644"},{value:"department_pending",label:"\u0645\u0647\u0627\u0645 \u0627\u0644\u0642\u0633\u0645 \u0627\u0644\u0645\u0639\u0644\u0642\u0629"},{value:"department_completed",label:"\u0645\u0647\u0627\u0645 \u0627\u0644\u0642\u0633\u0645 \u0627\u0644\u0645\u0646\u062c\u0632\u0629"},{value:"my_pending",label:"\u0645\u0647\u0627\u0645 \u0627\u0644\u0645\u0639\u0644\u0642\u0629 \u0645\u0646 \u0642\u0628\u0644\u064a"}],getOptionLabel:e=>e.label,getOptionValue:e=>e.value,placeholder:"\u0627\u0644\u0643\u0644",searchPlaceholder:"\u0627\u0628\u062d\u062b..."})]}),(0,q.jsxs)("div",{children:[(0,q.jsx)("label",{className:"block text-xs font-medium text-slate-500 mb-1",children:"\u0627\u0644\u062a\u0627\u0631\u064a\u062e"}),(0,q.jsx)(m.Z,{value:Q,onChange:e=>R(e),options:[{value:"all",label:"\u0639\u0627\u0645 (\u0643\u0644 \u0627\u0644\u0641\u062a\u0631\u0627\u062a)"},{value:"single",label:"\u064a\u0648\u0645 \u0645\u062d\u062f\u062f"},{value:"range",label:"\u0641\u062a\u0631\u0629 \u0645\u0639\u064a\u0646\u0629"}],getOptionLabel:e=>e.label,getOptionValue:e=>e.value,placeholder:"\u0627\u062e\u062a\u0631 \u0648\u0636\u0639 \u0627\u0644\u062a\u0627\u0631\u064a\u062e",searchPlaceholder:"\u0627\u0628\u062d\u062b..."})]}),"single"===Q&&(0,q.jsxs)("div",{children:[(0,q.jsx)("label",{className:"block text-xs font-medium text-slate-500 mb-1",children:"\u0627\u0644\u064a\u0648\u0645"}),(0,q.jsx)(o.p,{type:"date",value:U,onChange:e=>$(e.target.value),className:"border border-slate-200 rounded-lg"})]}),"range"===Q&&(0,q.jsxs)(q.Fragment,{children:[(0,q.jsxs)("div",{children:[(0,q.jsx)("label",{className:"block text-xs font-medium text-slate-500 mb-1",children:"\u0645\u0646"}),(0,q.jsx)(o.p,{type:"date",value:G,onChange:e=>W(e.target.value),className:"border border-slate-200 rounded-lg"})]}),(0,q.jsxs)("div",{children:[(0,q.jsx)("label",{className:"block text-xs font-medium text-slate-500 mb-1",children:"\u0625\u0644\u0649"}),(0,q.jsx)(o.p,{type:"date",value:J,onChange:e=>X(e.target.value),className:"border border-slate-200 rounded-lg"})]})]}),Ne&&(0,q.jsxs)("div",{children:[(0,q.jsx)("label",{className:"block text-xs font-medium text-slate-500 mb-1",children:"\u0627\u0644\u0645\u0633\u0624\u0648\u0644"}),(0,q.jsx)(m.Z,{value:ee,onChange:te,options:[{value:"",label:"\u0627\u0644\u0643\u0644"},...Fe.map(e=>({value:e.id.toString(),label:e.name}))],getOptionLabel:e=>e.label,getOptionValue:e=>e.value,placeholder:"\u0627\u0644\u0643\u0644",searchPlaceholder:"\u0627\u0628\u062d\u062b \u0639\u0646 \u0645\u0633\u062a\u062e\u062f\u0645..."})]})]})]}),Ye?(0,q.jsx)("div",{className:"rounded-2xl p-16 flex justify-center",style:{background:"var(--surface)",boxShadow:"var(--shadow-card)",border:"1px solid var(--border)"},children:(0,q.jsxs)("div",{className:"animate-pulse flex flex-col items-center gap-4",children:[(0,q.jsx)("div",{className:"w-14 h-14 rounded-2xl bg-slate-100"}),(0,q.jsx)("p",{className:"text-sm font-medium",style:{color:"var(--text-muted)"},children:"\u062c\u0627\u0631\u064a \u062a\u062d\u0645\u064a\u0644 \u0627\u0644\u0645\u0647\u0627\u0645..."})]})}):"table"===ae?(0,q.jsx)("div",{className:"overflow-x-auto",children:(0,q.jsxs)("table",{className:"ds-table w-full",children:[(0,q.jsx)("thead",{children:(0,q.jsxs)("tr",{className:"table-header-dark",style:{background:"linear-gradient(135deg, #026174 0%, #068294 100%)"},children:[(0,q.jsx)("th",{className:"text-end py-4 px-4 font-bold text-white",children:"\u0627\u0644\u0645\u0647\u0645\u0629"}),(0,q.jsx)("th",{className:"text-end py-4 px-4 font-bold text-white",children:"\u0627\u0644\u0646\u0648\u0639"}),(0,q.jsx)("th",{className:"text-end py-4 px-4 font-bold text-white",children:"\u0627\u0644\u0641\u0626\u0629"}),(0,q.jsx)("th",{className:"text-end py-4 px-4 font-bold text-white",children:"\u0627\u0644\u062d\u0627\u0644\u0629"}),(0,q.jsx)("th",{className:"text-end py-4 px-4 font-bold text-white",children:"\u0627\u0644\u062a\u0627\u0631\u064a\u062e"}),(0,q.jsx)("th",{className:"text-end py-4 px-4 font-bold text-white",children:"\u0627\u0644\u0645\u0633\u0624\u0648\u0644"}),(0,q.jsx)("th",{className:"text-end py-4 px-4 font-bold text-white",children:"\u0625\u062c\u0631\u0627\u0621\u0627\u062a"})]})}),(0,q.jsx)("tbody",{children:[...Ke?Oe.map(e=>(0,s.A)((0,s.A)({},e),{},{_rowType:"daily"})):[],...Ve?ze.map(e=>(0,s.A)((0,s.A)({},e),{},{_rowType:"ad-hoc"})):[]].map(e=>(0,q.jsxs)("tr",{children:[(0,q.jsx)("td",{className:"py-3 px-4 font-medium",style:{color:"var(--text-strong)"},children:e.template_title||e.title}),(0,q.jsx)("td",{className:"py-3 px-4",children:(0,q.jsx)("span",{className:"px-2 py-0.5 rounded text-xs font-medium",style:{background:"ad-hoc"===e._rowType?"rgba(124, 58, 237, 0.12)":"rgba(6, 130, 148, 0.12)",color:"ad-hoc"===e._rowType?"#7c3aed":"var(--primary-800)"},children:"ad-hoc"===e._rowType?"\u062e\u0627\u0635\u0629":"\u064a\u0648\u0645\u064a\u0629"})}),(0,q.jsx)("td",{className:"py-3 px-4",style:{color:"var(--text)"},children:e.category_name||"\u2014"}),(0,q.jsx)("td",{className:"py-3 px-4",children:Re(e.status)}),(0,q.jsx)("td",{className:"py-3 px-4",style:{color:"var(--text)"},dir:"ltr",children:e.task_date?F()(e.task_date).format("YYYY-MM-DD"):"\u2014"}),(0,q.jsx)("td",{className:"py-3 px-4",style:{color:"var(--text)"},children:e.assigned_to_name||e.created_by_name||"\u2014"}),(0,q.jsx)("td",{className:"py-3 px-4",children:(0,q.jsxs)("div",{className:"flex items-center gap-2 justify-end",children:[(0,q.jsxs)("button",{type:"button",onClick:()=>{xe((0,s.A)((0,s.A)({},e),{},{type:e._rowType})),me(!0)},className:"ds-btn ds-btn-outline flex items-center gap-1.5 px-3 py-1.5 text-sm",children:[(0,q.jsx)(w.A,{className:"w-3.5 h-3.5"})," \u062a\u0641\u0627\u0635\u064a\u0644"]}),"completed"!==e.status&&we&&(0,q.jsxs)("button",{type:"button",onClick:()=>Qe((0,s.A)((0,s.A)({},e),{},{type:e._rowType})),className:"ds-btn ds-btn-primary flex items-center gap-1.5 px-3 py-1.5 text-sm",children:[(0,q.jsx)(k.A,{className:"w-3.5 h-3.5"})," \u062a\u0646\u0641\u064a\u0630"]})]})})]},"".concat(e._rowType,"-").concat(e.id)))})]})}):(0,q.jsxs)("div",{className:"space-y-8",children:[Ke&&(0,q.jsxs)("div",{children:[(0,q.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,q.jsxs)("h2",{className:"text-xl font-bold flex items-center gap-2",style:{color:"var(--primary-800)"},children:[(0,q.jsx)(P.A,{className:"h-5 w-5"}),"\u0627\u0644\u0645\u0647\u0627\u0645 \u0627\u0644\u064a\u0648\u0645\u064a\u0629 \u0627\u0644\u0645\u062c\u062f\u0648\u0644\u0629",(0,q.jsx)("span",{className:"px-2.5 py-0.5 rounded-lg text-sm font-bold",style:{background:"rgba(6, 130, 148, 0.12)",color:"var(--primary-800)"},children:Oe.length})]})}),(0,q.jsx)("div",{className:"grid gap-5 sm:grid-cols-2 xl:grid-cols-3",children:(0,q.jsx)(i.N,{children:Oe.map((e,t)=>(0,q.jsx)(V,{task:e,index:t,type:"daily",getStatusBadge:Re,onDetails:()=>{xe((0,s.A)((0,s.A)({},e),{},{type:"daily"})),me(!0)},onExecute:()=>Qe((0,s.A)((0,s.A)({},e),{},{type:"daily"})),canExecute:we},"daily-".concat(e.id)))})}),0===Oe.length&&(0,q.jsx)(K,{message:"\u0644\u0627 \u062a\u0648\u062c\u062f \u0645\u0647\u0627\u0645 \u0645\u062c\u062f\u0648\u0644\u0629"})]}),Ve&&(0,q.jsxs)("div",{children:[(0,q.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,q.jsxs)("h2",{className:"text-xl font-bold flex items-center gap-2",style:{color:"var(--primary-800)"},children:[(0,q.jsx)(N.A,{className:"h-5 w-5"}),"\u0627\u0644\u0645\u0647\u0627\u0645 \u0627\u0644\u062e\u0627\u0635\u0629",(0,q.jsx)("span",{className:"px-2.5 py-0.5 rounded-lg text-sm font-bold",style:{background:"rgba(6, 130, 148, 0.12)",color:"var(--primary-800)"},children:ze.length})]})}),(0,q.jsx)("div",{className:"grid gap-5 sm:grid-cols-2 xl:grid-cols-3",children:(0,q.jsx)(i.N,{children:ze.map((e,t)=>(0,q.jsx)(V,{task:e,index:t,type:"ad-hoc",getStatusBadge:Re,onDetails:()=>{xe((0,s.A)((0,s.A)({},e),{},{type:"ad-hoc"})),me(!0)},onExecute:()=>{he((0,s.A)((0,s.A)({},e),{},{type:"ad-hoc"})),ie(!0)},canExecute:we},"ad-hoc-".concat(e.id)))})}),0===ze.length&&(0,q.jsx)(K,{message:"\u0644\u0627 \u062a\u0648\u062c\u062f \u0645\u0647\u0627\u0645 \u062e\u0627\u0635\u0629"})]})]}),(0,q.jsx)(u.lG,{open:ce,onOpenChange:me,children:(0,q.jsxs)(u.Cf,{className:"max-w-2xl max-h-[90vh] overflow-y-auto rounded-2xl",children:[(0,q.jsx)(u.c7,{children:(0,q.jsxs)(u.L3,{className:"text-2xl font-bold flex items-center gap-2",style:{color:O},children:[(0,q.jsx)(w.A,{className:"h-6 w-6"}),"\u062a\u0641\u0627\u0635\u064a\u0644 \u0627\u0644\u0645\u0647\u0645\u0629"]})}),ue&&(0,q.jsxs)("div",{className:"space-y-4",children:[(0,q.jsxs)("div",{className:"p-4 rounded-xl bg-slate-50 border border-slate-200",children:[(0,q.jsx)("h3",{className:"text-lg font-bold mb-2 text-slate-800",children:ue.template_title||ue.title}),ue.category_name&&(0,q.jsx)(c.E,{variant:"outline",className:"rounded-lg",children:ue.category_name}),Re(ue.status)]}),(0,q.jsxs)("div",{className:"grid gap-3 text-sm",children:["daily"===ue.type&&ue.assigned_to_name&&(0,q.jsx)(z,{label:"\u0627\u0644\u0645\u0633\u0624\u0648\u0644",value:ue.assigned_to_name}),ue.task_date&&(0,q.jsx)(z,{label:"\u0627\u0644\u062a\u0627\u0631\u064a\u062e",value:F()(ue.task_date).format("YYYY-MM-DD")}),ue.due_date_time&&(0,q.jsx)(z,{label:"\u0648\u0642\u062a \u0627\u0644\u0627\u0633\u062a\u062d\u0642\u0627\u0642",value:(0,j.cd)(ue.due_date_time)}),ue.description&&(0,q.jsx)(z,{label:"\u0627\u0644\u0648\u0635\u0641",value:ue.description,multiline:!0}),"ad-hoc"===ue.type&&ue.created_by_name&&(0,q.jsx)(z,{label:"\u0623\u0646\u0634\u0623\u0647\u0627",value:ue.created_by_name}),ue.beneficiary&&(0,q.jsx)(z,{label:"\u0627\u0644\u062c\u0647\u0629 \u0627\u0644\u0645\u0633\u062a\u0641\u064a\u062f\u0629",value:ue.beneficiary}),ue.notes&&(0,q.jsx)(z,{label:"\u0645\u0644\u0627\u062d\u0638\u0627\u062a",value:ue.notes,multiline:!0})]}),"completed"!==ue.status&&we&&(0,q.jsxs)(d.$,{className:"w-full rounded-xl text-white font-bold animate-pulse",style:{background:O,color:"#ffffff"},onClick:()=>{me(!1),Qe(ue)},children:[(0,q.jsx)(k.A,{className:"h-4 w-4 ml-2"}),"\u062a\u0646\u0641\u064a\u0630 \u0627\u0644\u0645\u0647\u0645\u0629"]})]})]})}),(0,q.jsx)(u.lG,{open:re,onOpenChange:e=>{ie(e),e||ye("")},children:(0,q.jsxs)(u.Cf,{className:"max-w-2xl",children:[(0,q.jsx)(u.c7,{children:(0,q.jsxs)("div",{className:"flex items-center gap-3",children:[(0,q.jsx)(H.v,{size:"sm",animated:!1}),(0,q.jsx)(u.L3,{className:"text-2xl font-bold",style:{color:O},children:"\u062a\u0646\u0641\u064a\u0630 \u0627\u0644\u0645\u0647\u0645\u0629"})]})}),(0,q.jsxs)("div",{className:"space-y-4",children:[(0,q.jsxs)("div",{className:"space-y-2",children:[(0,q.jsx)("label",{className:"text-sm font-semibold",children:"\u062d\u0627\u0644\u0629 \u0627\u0644\u062a\u0646\u0641\u064a\u0630"}),(0,q.jsx)(m.Z,{value:ge.resultStatus,onChange:e=>be((0,s.A)((0,s.A)({},ge),{},{resultStatus:e})),options:[{value:"completed",label:"\u0645\u0643\u062a\u0645\u0644\u0629 (\u0641\u064a \u0627\u0644\u0648\u0642\u062a)"},{value:"completed_late",label:"\u0645\u0643\u062a\u0645\u0644\u0629 (\u0645\u062a\u0623\u062e\u0631\u0629)"},{value:"skipped",label:"\u062a\u0645 \u0627\u0644\u062a\u062e\u0637\u064a"},{value:"cancelled",label:"\u0645\u0644\u063a\u0627\u0629"}],getOptionLabel:e=>e.label,getOptionValue:e=>e.value,placeholder:"\u0627\u062e\u062a\u0631 \u0627\u0644\u062d\u0627\u0644\u0629"})]}),Be&&("completed"===ge.resultStatus||"completed_late"===ge.resultStatus)&&(0,q.jsxs)("div",{className:"space-y-3 rounded-xl border-2 p-4",style:{borderColor:"rgba(6, 130, 148, 0.25)",background:"rgba(255,255,255,0.9)"},children:[(0,q.jsx)("p",{className:"text-sm font-semibold",style:{color:"#2A6E85"},children:"\u062a\u0623\u0643\u064a\u062f \u0627\u0644\u062a\u0633\u0648\u064a\u0629 (\u0645\u0637\u0627\u0628\u0642\u0629 \u0645\u0639 \u0635\u0641\u062d\u0629 \u0627\u0644\u062a\u0633\u0648\u064a\u0627\u062a \u0627\u0644\u062d\u0643\u0648\u0645\u064a\u0629)"}),(0,q.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[(0,q.jsxs)("div",{className:"space-y-1",children:[(0,q.jsx)("label",{className:"text-sm font-medium",children:"\u062a\u0627\u0631\u064a\u062e \u0627\u0644\u062a\u0633\u0648\u064a\u0629 *"}),(0,q.jsx)(o.p,{type:"date",value:ge.settlement_date,onChange:e=>be((0,s.A)((0,s.A)({},ge),{},{settlement_date:e.target.value})),className:"border-2"})]}),(0,q.jsxs)("div",{className:"space-y-1",children:[(0,q.jsx)("label",{className:"text-sm font-medium",children:"\u0642\u064a\u0645\u0629 \u0627\u0644\u062a\u0633\u0648\u064a\u0629 (STTLE) *"}),(0,q.jsx)(o.p,{type:"text",inputMode:"decimal",placeholder:"0.00",value:ge.settlement_value,onChange:e=>be((0,s.A)((0,s.A)({},ge),{},{settlement_value:e.target.value})),className:"border-2 font-mono",dir:"ltr"})]})]}),(0,q.jsx)("p",{className:"text-xs",style:{color:"#068294"},children:"\u064a\u062a\u0645 \u0645\u0642\u0627\u0631\u0646\u0629 \u0627\u0644\u0642\u064a\u0645\u0629 \u0645\u0639 \u0645\u062c\u0645\u0648\u0639 STTLE \u0641\u064a \u0635\u0641\u062d\u0629 \u0627\u0644\u062a\u0633\u0648\u064a\u0627\u062a \u0627\u0644\u062d\u0643\u0648\u0645\u064a\u0629 \u062d\u0633\u0628 \u0627\u0644\u062a\u0627\u0631\u064a\u062e \u0648\u0627\u0644\u0645\u0635\u0631\u0641. \u0639\u0646\u062f \u0627\u0644\u062a\u0637\u0627\u0628\u0642 \u062a\u064f\u0642\u0628\u0644 \u0627\u0644\u0645\u0647\u0645\u0629 \u0648\u062a\u0638\u0647\u0631 \xab\u062a\u0633\u0648\u064a\u0629 \u0645\u0637\u0627\u0628\u0642\u0629\xbb."})]}),(0,q.jsxs)("div",{className:"space-y-2",children:[(0,q.jsx)("label",{className:"text-sm font-semibold",children:"\u0645\u0644\u0627\u062d\u0638\u0627\u062a"}),(0,q.jsx)(x.T,{value:ge.notes,onChange:e=>be((0,s.A)((0,s.A)({},ge),{},{notes:e.target.value})),rows:4,className:"border-2"})]}),(0,q.jsxs)("div",{className:"space-y-2",children:[(0,q.jsx)("label",{className:"text-sm font-semibold",children:"\u0627\u0644\u0645\u062f\u0629 (\u062f\u0642\u064a\u0642\u0629) - \u0627\u062e\u062a\u064a\u0627\u0631\u064a"}),(0,q.jsx)(o.p,{type:"number",value:ge.durationMinutes,onChange:e=>be((0,s.A)((0,s.A)({},ge),{},{durationMinutes:e.target.value})),min:"0",className:"border-2"})]}),ve&&(0,q.jsx)("div",{className:"rounded-xl border-2 border-red-200 bg-red-50 p-3 text-sm text-red-800",role:"alert",children:ve})]}),(0,q.jsxs)(u.Es,{className:"gap-2 pt-4 border-t border-slate-200",children:[(0,q.jsx)(d.$,{variant:"outline",onClick:()=>ie(!1),className:"rounded-xl",children:"\u0625\u0644\u063a\u0627\u0621"}),(0,q.jsx)(d.$,{onClick:async()=>{if(pe){var e,t;if(Be&&("completed"===ge.resultStatus||"completed_late"===ge.resultStatus))if(null===(e=ge.settlement_date)||void 0===e||!e.trim()||null===(t=ge.settlement_value)||void 0===t||!t.trim())return void a({title:"\u062a\u0646\u0628\u064a\u0647",description:"\u0645\u0647\u0627\u0645 \u0627\u0644\u062a\u0633\u0648\u064a\u0629 \u0627\u0644\u062d\u0643\u0648\u0645\u064a\u0629 \u062a\u062a\u0637\u0644\u0628 \u062a\u0627\u0631\u064a\u062e \u0627\u0644\u062a\u0633\u0648\u064a\u0629 \u0648\u0642\u064a\u0645\u0629 \u0627\u0644\u062a\u0633\u0648\u064a\u0629",variant:"destructive"});ye("");try{const e="daily"===pe.type?Number(pe.id):void 0,t="ad-hoc"===pe.type?Number(pe.id):void 0;if("daily"===pe.type&&(null==e||Number.isNaN(e))||"ad-hoc"===pe.type&&(null==t||Number.isNaN(t)))return void ye("\u0645\u0639\u0631\u0641 \u0627\u0644\u0645\u0647\u0645\u0629 \u063a\u064a\u0631 \u0635\u0627\u0644\u062d. \u0623\u0639\u062f \u0641\u062a\u062d \u0627\u0644\u0635\u0641\u062d\u0629 \u0648\u062d\u0627\u0648\u0644 \u0645\u0631\u0629 \u0623\u062e\u0631\u0649.");const a={dailyTaskId:"daily"===pe.type?e:void 0,adHocTaskId:"ad-hoc"===pe.type?t:void 0,resultStatus:ge.resultStatus,notes:ge.notes,durationMinutes:ge.durationMinutes?parseInt(ge.durationMinutes,10):void 0};if(Be&&("completed"===ge.resultStatus||"completed_late"===ge.resultStatus)){var s,l,n,r;const e=(null===(s=ge.settlement_date)||void 0===s?void 0:s.trim().slice(0,10))||"";a.settlement_date=e.includes("/")?e.replace(/\//g,"-"):e;const t=null!==(l=null===(n=ge.settlement_value)||void 0===n||null===(r=n.replace)||void 0===r?void 0:r.call(n,/,/g,""))&&void 0!==l?l:ge.settlement_value;a.settlement_value=""===t?void 0:t}await Le.mutateAsync(a),je(!0)}catch(m){var i,d,o,c;const e=null===m||void 0===m||null===(i=m.response)||void 0===i?void 0:i.data,t=null===e||void 0===e?void 0:e.code,s=null!==(d=null!==(o=null!==(c=null===e||void 0===e?void 0:e.error)&&void 0!==c?c:null===e||void 0===e?void 0:e.message)&&void 0!==o?o:"string"===typeof e?e:null)&&void 0!==d?d:null!==m&&void 0!==m&&m.message&&"Network Error"!==m.message?m.message:"\u062d\u062f\u062b \u062e\u0637\u0623. \u062a\u062d\u0642\u0642 \u0645\u0646 \u0627\u0644\u0627\u062a\u0635\u0627\u0644 \u062b\u0645 \u0623\u0639\u062f \u0627\u0644\u0645\u062d\u0627\u0648\u0644\u0629.";if(ye(s+(null!=(null===e||void 0===e?void 0:e.expected_sum_sttle)?" (\u0627\u0644\u0645\u062a\u0648\u0642\u0639: ".concat(Number(e.expected_sum_sttle).toLocaleString("en-US"),")"):"")),"SETTLEMENT_MISMATCH"===t)return void a({title:"\u063a\u064a\u0631 \u0645\u0637\u0627\u0628\u0642\u0629",description:s+(null!=(null===e||void 0===e?void 0:e.expected_sum_sttle)?" (\u0627\u0644\u0645\u062a\u0648\u0642\u0639: ".concat(Number(e.expected_sum_sttle).toLocaleString("en-US"),")"):""),variant:"destructive"});a({title:"\u062e\u0637\u0623",description:s,variant:"destructive"})}}},disabled:Le.isPending,className:"rounded-xl font-semibold",style:{background:"linear-gradient(135deg, #026174, #068294)",color:"#fff"},children:Le.isPending?"\u062c\u0627\u0631\u064a \u0627\u0644\u062d\u0641\u0638...":"\u062d\u0641\u0638"})]})]})}),(0,q.jsx)(u.lG,{open:de,onOpenChange:oe,children:(0,q.jsxs)(u.Cf,{className:"max-w-lg",children:[(0,q.jsxs)(u.c7,{children:[(0,q.jsxs)("div",{className:"flex items-center gap-3",children:[(0,q.jsx)(H.v,{size:"sm",animated:!1}),(0,q.jsx)(u.L3,{className:"text-xl text-slate-900",children:"\u0625\u0646\u0634\u0627\u0621 \u0645\u0647\u0645\u0629 \u0645\u0646 \u0642\u0627\u0644\u0628"})]}),(0,q.jsx)("p",{className:"text-sm text-slate-500 mt-1",children:"\u0627\u062e\u062a\u0631 \u0642\u0627\u0644\u0628\u064b\u0627 \u0644\u0625\u0646\u0634\u0627\u0621 \u0645\u0647\u0645\u0629 \u062e\u0627\u0635\u0629 \u0641\u0648\u0631\u064b\u0627."})]}),(0,q.jsx)("div",{className:"space-y-4",children:(0,q.jsxs)("div",{className:"space-y-2",children:[(0,q.jsx)("label",{className:"text-sm font-medium text-slate-700",children:"\u0627\u062e\u062a\u0631 \u0642\u0627\u0644\u0628 \u0627\u0644\u0645\u0647\u0645\u0629 *"}),(0,q.jsx)(m.Z,{value:"",onChange:async e=>{const t=He.find(t=>t.id===parseInt(e));if(!t)return;const a=await Pe.mutateAsync({templateId:parseInt(e),categoryId:t.category_id,title:t.title,description:t.description});he((0,s.A)((0,s.A)({},a),{},{type:"ad-hoc"})),oe(!1),ie(!0)},options:He,getOptionLabel:e=>e.title,getOptionValue:e=>e.id.toString(),placeholder:"\u2014 \u0627\u062e\u062a\u0631 \u0642\u0627\u0644\u0628 \u2014",searchPlaceholder:"\u0627\u0628\u062d\u062b \u0639\u0646 \u0642\u0627\u0644\u0628..."})]})}),(0,q.jsx)(u.Es,{className:"gap-2 pt-4 border-t border-slate-200",children:(0,q.jsx)(d.$,{variant:"outline",onClick:()=>oe(!1),className:"rounded-xl",children:"\u0625\u0644\u063a\u0627\u0621"})})]})})]})})}}}]);
//# sourceMappingURL=639.9fe24d6d.chunk.js.map
"use strict";(self.webpackChunksttlment_client=self.webpackChunksttlment_client||[]).push([[733],{13733(e,s,a){a.r(s),a.d(s,{default:()=>c});var i=a(65043),l=a(94505),t=a(34348),d=a.n(t),r=a(70579);const c=()=>{var e;const[s,a]=(0,i.useState)(null),[t,c]=(0,i.useState)(0),[n,o]=(0,i.useState)(!0);(0,i.useEffect)(()=>{var e,a;m();const i=null!==(e=null===s||void 0===s||null===(a=s.settings)||void 0===a?void 0:a.refreshInterval)&&void 0!==e?e:30,l=Math.max(5e3,1e3*(i||30)),t=setInterval(m,l);return()=>clearInterval(t)},[null===s||void 0===s||null===(e=s.settings)||void 0===e?void 0:e.refreshInterval]),(0,i.useEffect)(()=>{if(null!==s&&void 0!==s&&s.slides){var e;const a=1e3*((null===(e=s.settings)||void 0===e?void 0:e.slideInterval)||10),i=setInterval(()=>{c(e=>(e+1)%s.slides.length)},a);return()=>clearInterval(i)}},[s]);const v="1"===new URLSearchParams(window.location.search).get("visitor"),m=async()=>{try{const e=await l.A.get("/tv-dashboard?visitorMode=".concat(v));a(e.data),o(!1)}catch(d){var e,s,i,t;console.error("\u062e\u0637\u0623 \u0641\u064a \u062c\u0644\u0628 \u0628\u064a\u0627\u0646\u0627\u062a \u0644\u0648\u062d\u0629 \u0627\u0644\u062a\u062d\u0643\u0645:",d),o(!1);let l="\u062d\u062f\u062b \u062e\u0637\u0623 \u0641\u064a \u062c\u0644\u0628 \u0627\u0644\u0628\u064a\u0627\u0646\u0627\u062a";"ECONNREFUSED"===d.code||null!==(e=d.message)&&void 0!==e&&e.includes("Network Error")?l="\u062e\u0637\u0623 \u0641\u064a \u0627\u0644\u0627\u062a\u0635\u0627\u0644 \u0628\u0627\u0644\u062e\u0627\u062f\u0645":500===(null===(s=d.response)||void 0===s?void 0:s.status)?l="\u062e\u0637\u0623 \u0641\u064a \u0627\u0644\u062e\u0627\u062f\u0645":null!==(i=d.response)&&void 0!==i&&null!==(t=i.data)&&void 0!==t&&t.error&&(l=d.response.data.error),a({error:!0,message:l})}};if(n||!s)return(0,r.jsxs)("div",{className:"tv-dashboard loading-screen",children:[(0,r.jsxs)("div",{className:"loading-content",children:[(0,r.jsx)("h1",{children:"\u0642\u0633\u0645 \u0627\u0644\u062a\u0633\u0648\u064a\u0627\u062a \u0648\u0627\u0644\u0645\u0637\u0627\u0628\u0642\u0629"}),(0,r.jsx)("p",{children:"\u062c\u0627\u0631\u064a \u0627\u0644\u062a\u062d\u0645\u064a\u0644..."})]}),(0,r.jsx)("div",{className:"tv-visitor-link",children:(0,r.jsx)("a",{href:v?"/tv":"/tv?visitor=1",children:v?"\u0639\u0631\u0636 \u0639\u0627\u062f\u064a":"\u0648\u0636\u0639 \u0627\u0644\u0632\u0627\u0626\u0631"})})]});if(s.error)return(0,r.jsxs)("div",{className:"tv-dashboard loading-screen",children:[(0,r.jsxs)("div",{className:"loading-content",children:[(0,r.jsx)("h1",{children:"\u0642\u0633\u0645 \u0627\u0644\u062a\u0633\u0648\u064a\u0627\u062a \u0648\u0627\u0644\u0645\u0637\u0627\u0628\u0642\u0629"}),(0,r.jsx)("p",{className:"tv-error-message",children:s.message||"\u062d\u062f\u062b \u062e\u0637\u0623"}),(0,r.jsx)("p",{className:"tv-error-hint",children:"\u064a\u0631\u062c\u0649 \u0627\u0644\u062a\u0623\u0643\u062f \u0645\u0646 \u0623\u0646 \u0627\u0644\u062e\u0627\u062f\u0645 \u064a\u0639\u0645\u0644"}),(0,r.jsx)("button",{onClick:()=>{o(!0),a(null),m()},className:"tv-retry-button",children:"\u0625\u0639\u0627\u062f\u0629 \u0627\u0644\u0645\u062d\u0627\u0648\u0644\u0629"})]}),(0,r.jsx)("div",{className:"tv-visitor-link",children:(0,r.jsx)("a",{href:v?"/tv":"/tv?visitor=1",children:v?"\u0639\u0631\u0636 \u0639\u0627\u062f\u064a":"\u0648\u0636\u0639 \u0627\u0644\u0632\u0627\u0626\u0631"})})]});const h=s.slides[t],j=d()().tz("Asia/Baghdad");return(0,r.jsxs)("div",{className:"tv-dashboard",children:[(()=>{switch(h.type){case"opening":return(0,r.jsxs)("div",{className:"slide opening-slide",children:[(0,r.jsx)("h1",{className:"main-title",children:h.title}),(0,r.jsx)("h2",{className:"sub-title",children:h.subtitle}),(0,r.jsxs)("div",{className:"date-time",children:[(0,r.jsx)("div",{className:"date",children:j.format("YYYY-MM-DD")}),(0,r.jsx)("div",{className:"time",children:j.format("HH:mm:ss")})]})]});case"overview":return(0,r.jsxs)("div",{className:"slide overview-slide",children:[(0,r.jsxs)("h1",{className:"slide-title",children:["\u0646\u0638\u0631\u0629 \u0639\u0627\u0645\u0629 - ",h.date]}),(0,r.jsxs)("div",{className:"stats-grid",children:[(0,r.jsxs)("div",{className:"stat-card large",children:[(0,r.jsx)("div",{className:"stat-label",children:"\u0627\u0644\u0645\u062c\u062f\u0648\u0644\u0629"}),(0,r.jsx)("div",{className:"stat-value",children:h.scheduled})]}),(0,r.jsxs)("div",{className:"stat-card success",children:[(0,r.jsx)("div",{className:"stat-label",children:"\u0645\u0643\u062a\u0645\u0644\u0629"}),(0,r.jsx)("div",{className:"stat-value",children:h.done})]}),(0,r.jsxs)("div",{className:"stat-card danger",children:[(0,r.jsx)("div",{className:"stat-label",children:"\u0645\u062a\u0623\u062e\u0631\u0629"}),(0,r.jsx)("div",{className:"stat-value",children:h.overdue})]}),(0,r.jsxs)("div",{className:"stat-card warning",children:[(0,r.jsx)("div",{className:"stat-label",children:"\u0645\u0643\u062a\u0645\u0644\u0629 \u0645\u062a\u0623\u062e\u0631\u0629"}),(0,r.jsx)("div",{className:"stat-value",children:h.late})]})]})]});case"overdue":return(0,r.jsxs)("div",{className:"slide overdue-slide",children:[(0,r.jsx)("h1",{className:"slide-title",children:"\u0627\u0644\u0645\u0647\u0627\u0645 \u0627\u0644\u0645\u062a\u0623\u062e\u0631\u0629"}),(0,r.jsx)("div",{className:"task-list",children:h.tasks.length>0?h.tasks.map((e,s)=>(0,r.jsxs)("div",{className:"task-item large",children:[(0,r.jsx)("div",{className:"task-title",children:e.title}),(0,r.jsxs)("div",{className:"task-meta",children:[e.assignedTo," - ",e.dueTime]})]},s)):(0,r.jsx)("div",{className:"no-data",children:"\u0644\u0627 \u062a\u0648\u062c\u062f \u0645\u0647\u0627\u0645 \u0645\u062a\u0623\u062e\u0631\u0629"})})]});case"coverage":return(0,r.jsxs)("div",{className:"slide coverage-slide",children:[(0,r.jsx)("h1",{className:"slide-title",children:"\u0627\u0644\u062a\u063a\u0637\u064a\u0629 - \u0645\u0646 \u0642\u0627\u0645 \u0628\u0645\u0647\u0627\u0645 \u0627\u0644\u0622\u062e\u0631\u064a\u0646"}),(0,r.jsx)("div",{className:"coverage-list",children:h.coverage.map((e,s)=>(0,r.jsxs)("div",{className:"coverage-item",children:[(0,r.jsx)("div",{className:"coverage-name",children:e.name}),(0,r.jsxs)("div",{className:"coverage-count",children:[e.count," \u0645\u0647\u0645\u0629"]})]},s))})]});case"attendance":return(0,r.jsxs)("div",{className:"slide attendance-slide",children:[(0,r.jsxs)("h1",{className:"slide-title",children:["\u0627\u0644\u062d\u0636\u0648\u0631 - ",h.date]}),(0,r.jsx)("div",{className:"attendance-stats",children:(0,r.jsxs)("div",{className:"attendance-total",children:["\u0627\u0644\u062d\u0627\u0636\u0631\u0648\u0646: ",h.present]})}),(0,r.jsx)("div",{className:"attendance-list",children:h.records.map((e,s)=>(0,r.jsxs)("div",{className:"attendance-item",children:[(0,r.jsx)("div",{className:"attendance-name",children:e.name}),(0,r.jsx)("div",{className:"attendance-time",children:e.time})]},s))})]});case"categories":return(0,r.jsxs)("div",{className:"slide categories-slide",children:[(0,r.jsxs)("h1",{className:"slide-title",children:["\u062a\u0648\u0632\u064a\u0639 \u0627\u0644\u0641\u0626\u0627\u062a - ",h.date]}),(0,r.jsx)("div",{className:"categories-list",children:h.categories.map((e,s)=>(0,r.jsxs)("div",{className:"category-item",children:[(0,r.jsx)("div",{className:"category-name",children:e.name}),(0,r.jsx)("div",{className:"category-count",children:e.count})]},s))})]});case"trends":return(0,r.jsxs)("div",{className:"slide trends-slide",children:[(0,r.jsx)("h1",{className:"slide-title",children:"\u0627\u0644\u0627\u062a\u062c\u0627\u0647\u0627\u062a \u0627\u0644\u0623\u0633\u0628\u0648\u0639\u064a\u0629"}),(0,r.jsx)("div",{className:"trends-chart",children:h.week.map((e,s)=>(0,r.jsxs)("div",{className:"trend-day",children:[(0,r.jsx)("div",{className:"trend-date",children:d()(e.date).format("ddd")}),(0,r.jsx)("div",{className:"trend-bar",children:(0,r.jsx)("div",{className:"trend-fill",style:{height:"".concat(e.completed/Math.max(e.total,1)*100,"%")}})}),(0,r.jsxs)("div",{className:"trend-value",children:[e.completed,"/",e.total]})]},s))})]});case"recognition":return(0,r.jsxs)("div",{className:"slide recognition-slide",children:[(0,r.jsx)("h1",{className:"slide-title",children:"\u0623\u0641\u0636\u0644 \u0627\u0644\u0623\u062f\u0627\u0621"}),(0,r.jsx)("div",{className:"recognition-list",children:h.topPerformers.map((e,s)=>(0,r.jsxs)("div",{className:"recognition-item",children:[(0,r.jsxs)("div",{className:"recognition-rank",children:["#",s+1]}),(0,r.jsx)("div",{className:"recognition-name",children:e.name}),(0,r.jsxs)("div",{className:"recognition-stats",children:[e.tasks," \u0645\u0647\u0645\u0629 (",e.onTime," \u0641\u064a \u0627\u0644\u0648\u0642\u062a)"]})]},s))})]});default:return(0,r.jsx)("div",{className:"slide",children:"\u0634\u0631\u064a\u062d\u0629 \u063a\u064a\u0631 \u0645\u0639\u0631\u0648\u0641\u0629"})}})(),(0,r.jsx)("div",{className:"tv-visitor-link",children:(0,r.jsx)("a",{href:v?"/tv":"/tv?visitor=1",children:v?"\u0639\u0631\u0636 \u0639\u0627\u062f\u064a":"\u0648\u0636\u0639 \u0627\u0644\u0632\u0627\u0626\u0631"})}),(0,r.jsx)("div",{className:"slide-indicator",children:s.slides.map((e,s)=>(0,r.jsx)("span",{className:s===t?"active":"",onClick:()=>c(s)},s))})]})}},94505(e,s,a){a.d(s,{A:()=>d});var i=a(79722);const l={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_WS_URL:"ws://localhost:5001"}.REACT_APP_API_URL||"http://localhost:5000/api",t=i.A.create({baseURL:l,headers:{"Content-Type":"application/json"}});t.interceptors.request.use(e=>{const s=localStorage.getItem("token");return s&&(e.headers.Authorization="Bearer ".concat(s)),e.data instanceof FormData&&delete e.headers["Content-Type"],e},e=>Promise.reject(e)),t.interceptors.response.use(e=>e,e=>{var s,a,i;return 401!==(null===(s=e.response)||void 0===s?void 0:s.status)||null!==(a=e.config)&&void 0!==a&&null!==(i=a.url)&&void 0!==i&&i.includes("/auth/login")||(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login"),Promise.reject(e)});const d=t}}]);
//# sourceMappingURL=733.bb84494d.chunk.js.map
{"version":3,"file":"static/js/733.bb84494d.chunk.js","mappings":"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","sources":["pages/TVDashboard.js","services/api.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport api from '../services/api';\nimport moment from 'moment-timezone';\n\nconst TVDashboard = () => {\n  const [data, setData] = useState(null);\n  const [currentSlide, setCurrentSlide] = useState(0);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    fetchData();\n    const sec = data?.settings?.refreshInterval ?? 30;\n    const ms = Math.max(5000, (sec || 30) * 1000);\n    const interval = setInterval(fetchData, ms);\n    return () => clearInterval(interval);\n  }, [data?.settings?.refreshInterval]); // eslint-disable-line react-hooks/exhaustive-deps\n\n  useEffect(() => {\n    if (data?.slides) {\n      const slideInterval = (data.settings?.slideInterval || 10) * 1000;\n      const timer = setInterval(() => {\n        setCurrentSlide((prev) => (prev + 1) % data.slides.length);\n      }, slideInterval);\n      return () => clearInterval(timer);\n    }\n  }, [data]);\n\n  const visitorFromUrl = new URLSearchParams(window.location.search).get('visitor') === '1';\n\n  const fetchData = async () => {\n    try {\n      const response = await api.get(`/tv-dashboard?visitorMode=${visitorFromUrl}`);\n      setData(response.data);\n      setLoading(false);\n    } catch (error) {\n      console.error('خطأ في جلب بيانات لوحة التحكم:', error);\n      // في حالة الخطأ، نعرض رسالة خطأ بدلاً من البقاء في حالة التحميل\n      setLoading(false);\n      \n      // تحديد نوع الخطأ\n      let errorMessage = 'حدث خطأ في جلب البيانات';\n      if (error.code === 'ECONNREFUSED' || error.message?.includes('Network Error')) {\n        errorMessage = 'خطأ في الاتصال بالخادم';\n      } else if (error.response?.status === 500) {\n        errorMessage = 'خطأ في الخادم';\n      } else if (error.response?.data?.error) {\n        errorMessage = error.response.data.error;\n      }\n      \n      setData({\n        error: true,\n        message: errorMessage\n      });\n    }\n  };\n\n  if (loading || !data) {\n    return (\n      <div className=\"tv-dashboard loading-screen\">\n        <div className=\"loading-content\">\n          <h1>قسم التسويات والمطابقة</h1>\n          <p>جاري التحميل...</p>\n        </div>\n        <div className=\"tv-visitor-link\">\n          <a href={visitorFromUrl ? '/tv' : '/tv?visitor=1'}>\n            {visitorFromUrl ? 'عرض عادي' : 'وضع الزائر'}\n          </a>\n        </div>\n      </div>\n    );\n  }\n\n  // عرض رسالة خطأ إذا فشل جلب البيانات\n  if (data.error) {\n    return (\n      <div className=\"tv-dashboard loading-screen\">\n        <div className=\"loading-content\">\n          <h1>قسم التسويات والمطابقة</h1>\n          <p className=\"tv-error-message\">{data.message || 'حدث خطأ'}</p>\n          <p className=\"tv-error-hint\">\n            يرجى التأكد من أن الخادم يعمل\n          </p>\n          <button\n            onClick={() => {\n              setLoading(true);\n              setData(null);\n              fetchData();\n            }}\n            className=\"tv-retry-button\"\n          >\n            إعادة المحاولة\n          </button>\n        </div>\n        <div className=\"tv-visitor-link\">\n          <a href={visitorFromUrl ? '/tv' : '/tv?visitor=1'}>\n            {visitorFromUrl ? 'عرض عادي' : 'وضع الزائر'}\n          </a>\n        </div>\n      </div>\n    );\n  }\n\n  const slide = data.slides[currentSlide];\n  const now = moment().tz('Asia/Baghdad');\n\n  const renderSlide = () => {\n    switch (slide.type) {\n      case 'opening':\n        return (\n          <div className=\"slide opening-slide\">\n            <h1 className=\"main-title\">{slide.title}</h1>\n            <h2 className=\"sub-title\">{slide.subtitle}</h2>\n            <div className=\"date-time\">\n              <div className=\"date\">{now.format('YYYY-MM-DD')}</div>\n              <div className=\"time\">{now.format('HH:mm:ss')}</div>\n            </div>\n          </div>\n        );\n\n      case 'overview':\n        return (\n          <div className=\"slide overview-slide\">\n            <h1 className=\"slide-title\">نظرة عامة - {slide.date}</h1>\n            <div className=\"stats-grid\">\n              <div className=\"stat-card large\">\n                <div className=\"stat-label\">المجدولة</div>\n                <div className=\"stat-value\">{slide.scheduled}</div>\n              </div>\n              <div className=\"stat-card success\">\n                <div className=\"stat-label\">مكتملة</div>\n                <div className=\"stat-value\">{slide.done}</div>\n              </div>\n              <div className=\"stat-card danger\">\n                <div className=\"stat-label\">متأخرة</div>\n                <div className=\"stat-value\">{slide.overdue}</div>\n              </div>\n              <div className=\"stat-card warning\">\n                <div className=\"stat-label\">مكتملة متأخرة</div>\n                <div className=\"stat-value\">{slide.late}</div>\n              </div>\n            </div>\n          </div>\n        );\n\n      case 'overdue':\n        return (\n          <div className=\"slide overdue-slide\">\n            <h1 className=\"slide-title\">المهام المتأخرة</h1>\n            <div className=\"task-list\">\n              {slide.tasks.length > 0 ? (\n                slide.tasks.map((task, idx) => (\n                  <div key={idx} className=\"task-item large\">\n                    <div className=\"task-title\">{task.title}</div>\n                    <div className=\"task-meta\">{task.assignedTo} - {task.dueTime}</div>\n                  </div>\n                ))\n              ) : (\n                <div className=\"no-data\">لا توجد مهام متأخرة</div>\n              )}\n            </div>\n          </div>\n        );\n\n      case 'coverage':\n        return (\n          <div className=\"slide coverage-slide\">\n            <h1 className=\"slide-title\">التغطية - من قام بمهام الآخرين</h1>\n            <div className=\"coverage-list\">\n              {slide.coverage.map((item, idx) => (\n                <div key={idx} className=\"coverage-item\">\n                  <div className=\"coverage-name\">{item.name}</div>\n                  <div className=\"coverage-count\">{item.count} مهمة</div>\n                </div>\n              ))}\n            </div>\n          </div>\n        );\n\n      case 'attendance':\n        return (\n          <div className=\"slide attendance-slide\">\n            <h1 className=\"slide-title\">الحضور - {slide.date}</h1>\n            <div className=\"attendance-stats\">\n              <div className=\"attendance-total\">الحاضرون: {slide.present}</div>\n            </div>\n            <div className=\"attendance-list\">\n              {slide.records.map((record, idx) => (\n                <div key={idx} className=\"attendance-item\">\n                  <div className=\"attendance-name\">{record.name}</div>\n                  <div className=\"attendance-time\">{record.time}</div>\n                </div>\n              ))}\n            </div>\n          </div>\n        );\n\n      case 'categories':\n        return (\n          <div className=\"slide categories-slide\">\n            <h1 className=\"slide-title\">توزيع الفئات - {slide.date}</h1>\n            <div className=\"categories-list\">\n              {slide.categories.map((cat, idx) => (\n                <div key={idx} className=\"category-item\">\n                  <div className=\"category-name\">{cat.name}</div>\n                  <div className=\"category-count\">{cat.count}</div>\n                </div>\n              ))}\n            </div>\n          </div>\n        );\n\n      case 'trends':\n        return (\n          <div className=\"slide trends-slide\">\n            <h1 className=\"slide-title\">الاتجاهات الأسبوعية</h1>\n            <div className=\"trends-chart\">\n              {slide.week.map((day, idx) => (\n                <div key={idx} className=\"trend-day\">\n                  <div className=\"trend-date\">{moment(day.date).format('ddd')}</div>\n                  <div className=\"trend-bar\">\n                    <div\n                      className=\"trend-fill\"\n                      style={{ height: `${(day.completed / Math.max(day.total, 1)) * 100}%` }}\n                    />\n                  </div>\n                  <div className=\"trend-value\">{day.completed}/{day.total}</div>\n                </div>\n              ))}\n            </div>\n          </div>\n        );\n\n      case 'recognition':\n        return (\n          <div className=\"slide recognition-slide\">\n            <h1 className=\"slide-title\">أفضل الأداء</h1>\n            <div className=\"recognition-list\">\n              {slide.topPerformers.map((performer, idx) => (\n                <div key={idx} className=\"recognition-item\">\n                  <div className=\"recognition-rank\">#{idx + 1}</div>\n                  <div className=\"recognition-name\">{performer.name}</div>\n                  <div className=\"recognition-stats\">\n                    {performer.tasks} مهمة ({performer.onTime} في الوقت)\n                  </div>\n                </div>\n              ))}\n            </div>\n          </div>\n        );\n\n      default:\n        return <div className=\"slide\">شريحة غير معروفة</div>;\n    }\n  };\n\n  return (\n    <div className=\"tv-dashboard\">\n      {renderSlide()}\n      <div className=\"tv-visitor-link\">\n        <a href={visitorFromUrl ? '/tv' : '/tv?visitor=1'}>\n          {visitorFromUrl ? 'عرض عادي' : 'وضع الزائر'}\n        </a>\n      </div>\n      <div className=\"slide-indicator\">\n        {data.slides.map((_, idx) => (\n          <span\n            key={idx}\n            className={idx === currentSlide ? 'active' : ''}\n            onClick={() => setCurrentSlide(idx)}\n          />\n        ))}\n      </div>\n    </div>\n  );\n};\n\nexport default TVDashboard;","import axios from 'axios';\n\nconst API_URL = process.env.REACT_APP_API_URL ||\n  (process.env.NODE_ENV === 'development' ? '/api' : 'http://localhost:5000/api');\n\nconst api = axios.create({\n  baseURL: API_URL,\n  headers: {\n    'Content-Type': 'application/json'\n  }\n});\n\n// إضافة التوكن تلقائياً؛ عدم فرض JSON عند إرسال FormData (مرفقات)\napi.interceptors.request.use(\n  (config) => {\n    const token = localStorage.getItem('token');\n    if (token) config.headers.Authorization = `Bearer ${token}`;\n    if (config.data instanceof FormData) delete config.headers['Content-Type'];\n    return config;\n  },\n  (error) => Promise.reject(error)\n);\n\n// معالجة الأخطاء\napi.interceptors.response.use(\n  (response) => response,\n  (error) => {\n    if (error.response?.status === 401 && !error.config?.url?.includes('/auth/login')) {\n      localStorage.removeItem('token');\n      localStorage.removeItem('user');\n      window.location.href = '/login';\n    }\n    return Promise.reject(error);\n  }\n);\n\nexport default api;"],"names":["TVDashboard","_data$settings2","data","setData","useState","currentSlide","setCurrentSlide","loading","setLoading","useEffect","_data$settings$refres","_data$settings","fetchData","sec","settings","refreshInterval","ms","Math","max","interval","setInterval","clearInterval","slides","_data$settings3","slideInterval","timer","prev","length","visitorFromUrl","URLSearchParams","window","location","search","get","async","response","api","concat","error","_error$message","_error$response","_error$response2","_error$response2$data","console","errorMessage","code","message","includes","status","_jsxs","className","children","_jsx","href","onClick","slide","now","moment","tz","renderSlide","type","title","subtitle","format","date","scheduled","done","overdue","late","tasks","map","task","idx","assignedTo","dueTime","coverage","item","name","count","present","records","record","time","categories","cat","week","day","style","height","completed","total","topPerformers","performer","onTime","_","API_URL","process","REACT_APP_API_URL","axios","create","baseURL","headers","interceptors","request","use","config","token","localStorage","getItem","Authorization","FormData","Promise","reject","_error$config","_error$config$url","url","removeItem"],"ignoreList":[],"sourceRoot":""}
# نشر النظام الآن (Render.com)

## 1. رفع الكود إلى GitHub

تأكد أن آخر التعديلات مرفوعة إلى المستودع:

```bash
git add .
git status
git commit -m "جاهز للنشر: تحسينات أداء، RTGS، تقارير"
git push origin main
```

> إذا كان المستودع باسم آخر (مثلاً `master`) استبدل `main` باسم الفرع.

---

## 2. النشر على Render بالـ Blueprint

1. ادخل إلى **[render.com](https://render.com)** وسجّل الدخول (أو أنشئ حساباً).
2. من لوحة التحكم: **New +** → **Blueprint**.
3. وصّل حساب **GitHub** واختر المستودع الذي فيه المشروع (مثلاً `sttlment` أو `HAIDERMUAYID/sttlment`).
4. Render سيكتشف ملف **`render.yaml`** تلقائياً وينشئ:
   - **Web Service** (sttlment-api) — واجهة API + واجهة المستخدم
   - **PostgreSQL** (sttlment-db)
   - **Cron Jobs** — توليد المهام اليومية وفحص المتأخرة
5. اضغط **Apply** وانتظر اكتمال البناء (حوالي 5–10 دقائق).

---

## 3. بعد اكتمال البناء

1. احصل على رابط التطبيق، مثلاً:  
   `https://sttlment-api.onrender.com`
2. افتح **Shell** للخدمة (من صفحة الخدمة → **Shell**)، ثم نفّذ:

   ```bash
   npm run migrate
   npm run seed
   ```

   (أو `npm run seed:full` إن كنت تريد بيانات تجريبية كاملة.)

3. جرّب الدخول إلى الرابط وتسجيل الدخول بالمستخدم الافتراضي (راجع `TEST_DATA.md` أو ملف الـ seed).

---

## 4. ملاحظات

- **الخطة المجانية:** الخدمة قد تتوقف بعد ~15 دقيقة خمول؛ أول طلب بعدها قد يستغرق 30–60 ثانية حتى يعود التشغيل.
- **API وواجهة المستخدم:** يعملان على نفس الرابط (لا حاجة لـ `REACT_APP_API_URL` أو `REACT_APP_WS_URL`).
- **HTTPS و WebSocket:** Render يوفّر HTTPS تلقائياً، والـ WebSocket يعمل على نفس النطاق (`wss://...`).

---

## 5. إذا فشل البناء بسبب ESLint (تحذيرات تُعتبر أخطاء)

في لوحة Render → الخدمة → **Environment** أضف متغيراً:

- **CI** = `false`

ثم أعد النشر (Manual Deploy → Deploy latest commit).

---

## 6. التحقق بعد النشر

- افتح: `https://your-app.onrender.com`
- تحقق من الصحة: `https://your-app.onrender.com/api/health`
- جرّب تسجيل الدخول والتنقل بين الصفحات.

بعد تنفيذ الخطوات أعلاه يكون النظام منشوراً وجاهزاً للاستخدام.
